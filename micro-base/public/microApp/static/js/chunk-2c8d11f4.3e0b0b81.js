(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-2c8d11f4"],{"3b2b":function(e,t,a){var i=a("7726"),s=a("5dbc"),o=a("86cc").f,r=a("9093").f,l=a("aae3"),n=a("0bfb"),c=i.RegExp,d=c,u=c.prototype,m=/a/g,p=/a/g,f=new c(m)!==m;if(a("9e1e")&&(!f||a("79e5")((function(){return p[a("2b4c")("match")]=!1,c(m)!=m||c(p)==p||"/a/i"!=c(m,"i")})))){c=function(e,t){var a=this instanceof c,i=l(e),o=void 0===t;return!a&&i&&e.constructor===c&&o?e:s(f?new d(i&&!o?e.source:e,t):d((i=e instanceof c)?e.source:e,i&&o?n.call(e):t),a?this:u,c)};for(var g=function(e){e in c||o(c,e,{configurable:!0,get:function(){return d[e]},set:function(t){d[e]=t}})},v=r(d),y=0;v.length>y;)g(v[y++]);u.constructor=c,c.prototype=u,a("2aba")(i,"RegExp",c)}a("7a56")("RegExp")},"3c42":function(e,t,a){"use strict";var i=a("da12"),s=a.n(i);s.a},"75fb":function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return l}));a("3b2b");var i=function(e){var t=new RegExp("^[1][3-9][0-9]{9}$");return t.test(e)},s=function(e){var t="image/jpeg"===e.type,a="image/jpg"===e.type,i="image/png"===e.type,s="image/bmp"===e.type,o=e.size/1024/1024<10;return t||a||i||s?o?{status:!0,message:""}:{status:!1,message:"上传图片大小不能超过 10MB!"}:{status:!1,message:"上传图片必须是/jpg/jpeg/png/bmp格式!"}};function o(e){var t={value:e,unit:"KB"};return e/=1024,e>=1&&(t.value=+e.toFixed(2),t.unit="MB",e/=1024,e>=1&&(t.value=+e.toFixed(2),t.unit="GB",e/=1024,e>=1&&(t.value=+e.toFixed(2),t.unit="TB"))),t}function r(e){var t=e.value,a=e.unit;switch(a){case"KB":return Math.floor(t);case"MB":return Math.floor(1024*t);case"GB":return Math.floor(1024*t*1024);case"TB":return Math.floor(1024*t*1024*1024)}}var l=function(e,t){if(console.log(e),t){if(t.formatList&&t.formatList.every((function(t){return e.type!=="image/"+t})))return{status:!1,message:"上传图片必须是/".concat(t.formatList.join("/"),"格式!")};if(t.maxKbSize&&e.size/1024>t.maxKbSize){var a=o(t.maxKbSize);return{status:!1,message:"上传图片大小不能超过 ".concat(a.value).concat(a.unit,"!")}}}return{status:!0,message:""}}},9204:function(e,t,a){},"9a75":function(e,t,a){"use strict";var i=a("9204"),s=a.n(i);s.a},b5d9:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("q-left-right-layout",{attrs:{"left-title":e.typeObject.name,"btn-tip":"添加一级节点","right-title":(e.basicForm.name||"")+"详情"},on:{click:function(t){return e.openTypeTreeNodeForm("addTop","")}}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("el-input",{staticStyle:{"margin-bottom":"10px",padding:"0 10px"},attrs:{placeholder:"输入关键字进行过滤",size:"small",maxlength:100},model:{value:e.treeMessage.filterText,callback:function(t){e.$set(e.treeMessage,"filterText",t)},expression:"treeMessage.filterText"}}),a("div",{staticClass:"tree-content"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.treeMessage.data,props:e.treeMessage.defaultProps,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticStyle:{display:"inline-block","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","word-break":"keep-all"},style:{width:190-18*(i.level-1)+"px"},attrs:{title:i.label}},[e._v("\n              "+e._s(i.label)+"\n            ")]),a("span",[a("el-button",{staticClass:"el-icon-plus",attrs:{type:"text",size:"mini",title:"添加子节点"},on:{click:function(t){return e.openTypeTreeNodeForm("add",s)}}}),a("el-button",{staticClass:"el-icon-edit",attrs:{type:"text",size:"mini",title:"编辑节点"},on:{click:function(t){return e.openTypeTreeNodeForm("edit",s)}}}),a("el-button",{staticClass:"el-icon-delete",attrs:{type:"text",size:"mini",title:"删除节点"},on:{click:function(t){return e.remove(i,s)}}})],1)])}}])})],1)],1),a("div",{staticClass:"right",attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"basic-attribute"},[a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu"}),e._v("基础信息")]),a("div",{staticClass:"basic-attribute-body"},[a("el-form",{attrs:{"label-width":"100px",size:"small","status-icon":"",model:e.basicForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"名称：",prop:"name"}},[a("el-input",{attrs:{disabled:""},model:{value:e.basicForm.name,callback:function(t){e.$set(e.basicForm,"name",t)},expression:"basicForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"父节点名称："}},[a("el-input",{attrs:{disabled:""},model:{value:e.basicForm.parentName,callback:function(t){e.$set(e.basicForm,"parentName",t)},expression:"basicForm.parentName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"编号：",prop:"code"}},[a("el-input",{attrs:{disabled:""},model:{value:e.basicForm.code,callback:function(t){e.$set(e.basicForm,"code",t)},expression:"basicForm.code"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"图标：",prop:"icons"}},[a("q-upload",{attrs:{disabled:"","limit-num":1,accept:"image/png,image/jpeg",size:2},model:{value:e.basicForm.icons,callback:function(t){e.$set(e.basicForm,"icons",t)},expression:"basicForm.icons"}})],1)],1)],1)],1)],1)]),a("device-status-list",{attrs:{id:e.basicForm.id}}),e.hasCustomRole?a("div",{staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"content-title"},[a("el-icon",{staticClass:"el-icon-menu icon-blue"}),e._v("\n          自定义信息\n        ")],1),a("base-data-info-table",{ref:"baseDataInfoTable",attrs:{id:e.basicForm.id,active:"/admin/typeDetail/attr/pagingAttr/device/"}})],1):e._e()],1)]),a("el-dialog",{attrs:{title:"添加"+e.typeObject.name,visible:e.typeTreeNodeDialog,"close-on-click-modal":!1,width:"564px"},on:{"update:visible":function(t){e.typeTreeNodeDialog=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dialogBasicForm",attrs:{"label-width":"100px",size:"small",model:e.dialogBasicForm,rules:e.dialogBasicFormRules}},[a("el-form-item",{attrs:{label:"类型名称：",prop:"name"}},[a("el-input",{attrs:{maxlength:100,placeholder:"请输入类型名称"},model:{value:e.dialogBasicForm.name,callback:function(t){e.$set(e.dialogBasicForm,"name",t)},expression:"dialogBasicForm.name"}})],1),a("el-form-item",{attrs:{label:"类型编码：",prop:"code"}},[a("el-input",{attrs:{maxlength:100,placeholder:"包含字母、数字、横线、下划线和点,点不能作为开头,长度3-100位"},model:{value:e.dialogBasicForm.code,callback:function(t){e.$set(e.dialogBasicForm,"code",t)},expression:"dialogBasicForm.code"}})],1),a("el-form-item",{attrs:{label:"图标：",prop:"icons"}},[a("q-upload",{attrs:{prev:!1,"limit-num":1,accept:"image/png,image/jpeg",size:2},model:{value:e.dialogBasicForm.icons,callback:function(t){e.$set(e.dialogBasicForm,"icons",t)},expression:"dialogBasicForm.icons"}})],1),e.hasCustomRole?a("div",{staticClass:"transfer"},[a("el-transfer",{staticStyle:{margin:"auto"},attrs:{filterable:"",titles:["未选择","已选择"],"button-texts":["解绑","绑定"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:e.transferData.data},model:{value:e.transferData.selected,callback:function(t){e.$set(e.transferData,"selected",t)},expression:"transferData.selected"}})],1):e._e(),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.typeTreeNodeDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.saveTypeAndAttr()}}},[e._v("确定")])],1)],1)],1)],1)},s=[],o=(a("ac6a"),a("d225")),r=a("b0b4"),l=a("308d"),n=a("6bb5"),c=a("4e2b"),d=a("9ab4"),u=a("60a3"),m=a("ef0f"),p=a("0933"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"basic-attribute",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"header"},[e._m(0),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAddStatus}},[e._v("添加新状态")])],1),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.statusList}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"name",label:"设备状态","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"level",label:"状态等级",formatter:function(e){return e.level||"-"},"show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"styleType",label:"状态样式",formatter:function(e){return{none:"无",bubble:"冒泡",twinkle:"高亮闪烁",point:"点",custom:"自定义"}[e.styleType]},"show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),t.row.defaultStatus?e._e():[a("span",{staticClass:"divide"},[e._v("|")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]]}}])})],1),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialog,"close-on-click-modal":!1,width:"560px"},on:{"update:visible":function(t){e.dialog=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,size:"small","label-width":"80px"}},[a("el-form-item",{attrs:{prop:"name",label:"状态名称"}},[a("el-input",{attrs:{placeholder:"请输入状态名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{prop:"code",label:"状态编码"}},[a("el-input",{attrs:{placeholder:"请输入状态编码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),a("el-form-item",{attrs:{prop:"level",label:"状态等级"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},[a("el-option",{attrs:{value:1}}),a("el-option",{attrs:{value:2}}),a("el-option",{attrs:{value:3}})],1)],1),a("el-form-item",{attrs:{prop:"styleType",label:"状态样式"}},[a("el-radio-group",{model:{value:e.form.styleType,callback:function(t){e.$set(e.form,"styleType",t)},expression:"form.styleType"}},[a("el-radio",{attrs:{label:"none"}},[e._v("无")]),a("el-radio",{attrs:{label:"bubble"}},[e._v("冒泡")]),a("el-radio",{attrs:{label:"twinkle"}},[e._v("高亮闪烁")])],1)],1),a("el-form-item",{attrs:{prop:"styleSize",label:"样式大小"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.styleSize,callback:function(t){e.$set(e.form,"styleSize",t)},expression:"form.styleSize"}},[a("el-option",{attrs:{value:1}}),a("el-option",{attrs:{value:2}}),a("el-option",{attrs:{value:3}})],1)],1),a("el-form-item",{attrs:{prop:"styleColor",label:"样式颜色"}},[a("div",{staticClass:"color"},[a("div",{staticClass:"value"},[e._v(e._s(e.form.styleColor))]),a("el-color-picker",{attrs:{size:"mini"},model:{value:e.form.styleColor,callback:function(t){e.$set(e.form,"styleColor",t)},expression:"form.styleColor"}})],1)])],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)]),a("el-dialog",{attrs:{title:"默认状态",visible:e.defaultDialog,"close-on-click-modal":!1,width:"480px"},on:{"update:visible":function(t){e.defaultDialog=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[a("el-form",{ref:"defaultForm",attrs:{model:e.form,rules:e.formRules,size:"small","label-width":"80px"}},[a("el-form-item",{attrs:{prop:"styleType",label:"状态样式"}},[a("el-radio-group",{model:{value:e.form.styleType,callback:function(t){e.$set(e.form,"styleType",t)},expression:"form.styleType"}},[a("el-radio-button",{attrs:{label:"point"}},[e._v("点")]),a("el-radio-button",{attrs:{label:"custom"}},[e._v("自定义")])],1)],1),"point"===e.form.styleType?a("div",{key:"point"},[a("el-form-item",{attrs:{prop:"styleSize",label:"样式大小"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.styleSize,callback:function(t){e.$set(e.form,"styleSize",t)},expression:"form.styleSize"}},[a("el-option",{attrs:{value:1}}),a("el-option",{attrs:{value:2}}),a("el-option",{attrs:{value:3}})],1)],1),a("el-form-item",{attrs:{prop:"styleColor",label:"样式颜色"}},[a("div",{staticClass:"color"},[a("div",{staticClass:"value"},[e._v(e._s(e.form.styleColor))]),a("el-color-picker",{attrs:{size:"mini"},model:{value:e.form.styleColor,callback:function(t){e.$set(e.form,"styleColor",t)},expression:"form.styleColor"}})],1)])],1):"custom"===e.form.styleType?a("div",{key:"custom"},[a("el-form-item",{attrs:{prop:"styleSize",label:"样式大小"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.styleSize,callback:function(t){e.$set(e.form,"styleSize",t)},expression:"form.styleSize"}},[a("el-option",{attrs:{value:1}}),a("el-option",{attrs:{value:2}}),a("el-option",{attrs:{value:3}})],1)],1),a("el-form-item",{attrs:{prop:"styleImg",label:"图标"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.styleImg,expression:"form.styleImg"}],staticClass:"upload-img"},[a("img",{attrs:{src:e.form.styleImg,alt:""}}),a("div",{staticClass:"mask",on:{click:e.handleRemoveIcon}},[a("i",{staticClass:"el-icon-delete"})])]),a("el-upload",{directives:[{name:"show",rawName:"v-show",value:!e.form.styleImg,expression:"!form.styleImg"}],ref:"upload",attrs:{action:"/api/file/upload","list-type":"picture-card","http-request":e.customHttpRequest,"on-change":e.customChange,accept:"image/jpeg,image/png,image/jpg","auto-upload":!1,multiple:!1,"show-file-list":!1,limit:1}},[a("i",{staticClass:"el-icon-plus"})])],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.defaultDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)])],1)},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu"}),e._v("设备状态")])}],v=(a("8e6e"),a("456d"),a("bd86")),y=(a("96cf"),a("3b8d")),h=a("73ec"),b=a("75fb");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){Object(v["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.statusList=[],e.dialog=!1,e.dialogTitle="",e.dialogLoading=!1,e.form={code:""},e.code="",e.validateCode=function(e,t,a){if(!t)return a(new Error("请输入状态编码"));var i=/^[A-Za-z0-9_\\-][A-Za-z0-9_\-\\.]{2,99}$/;if(!i.test(t))return a(new Error("编码以英文或下划线开头，可包含英文句号、减号、下划线和数字，长度3-100位"));a()},e.formRules={name:{required:!0,message:"请输入状态名称",trigger:"blur"},code:{required:!0,validator:e.validateCode,trigger:"blur"},level:{required:!0,message:"请选择状态等级",trigger:"change"},styleType:{required:!0,message:"请选择状态样式",trigger:"change"},styleSize:{required:!0,message:"请选择样式大小",trigger:"change"},styleColor:{required:!0,message:"请选择状态颜色",trigger:"change"},styleImg:{required:!0,message:"请选择上传图标",trigger:"change"}},e.defaultDialog=!1,e}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"handleIdChange",value:function(){this.getStatusList()}},{key:"getStatusList",value:function(){var e=Object(y["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(m["a"].getDeviceTypeStatusList+this.id);case 2:t=e.sent,a=t.data,i=a.status,s=a.data,o=a.message,i?this.statusList=s:this.$message.error(o);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleAddStatus",value:function(){var e=this;this.dialog=!0,this.dialogTitle="添加新状态",this.form={styleColor:"#00ff00",level:1,styleType:"none",styleSize:1},this.code="",this.$nextTick((function(){e.$refs.form&&e.$refs.form.clearValidate(),e.$refs.defaultForm&&e.$refs.defaultForm.clearValidate()}))}},{key:"handleEdit",value:function(e){var t=this;this.getStatusInfoByStatusId(e).then((function(){e.defaultStatus?t.defaultDialog=!0:(t.dialog=!0,t.dialogTitle="修改状态"),t.$nextTick((function(){t.$refs.form&&t.$refs.form.clearValidate(),t.$refs.defaultForm&&t.$refs.defaultForm.clearValidate()}))}))}},{key:"getStatusInfoByStatusId",value:function(){var e=Object(y["a"])(regeneratorRuntime.mark((function e(t){var a,i,s,o,r,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(m["a"].getStatusInfoByStatusId+t.id);case 2:a=e.sent,i=a.data,s=i.status,o=i.data,r=i.message,s?(this.form=o,l=this.form,l.code=t.code,this.form=JSON.parse(JSON.stringify(l))):this.$message.error(r);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleSubmit",value:function(){var e=this;(this.dialog?this.$refs.form:this.$refs.defaultForm).validate((function(t){t&&(e.dialogLoading=!0,e.form.needUpload?(delete e.form.needUpload,e.$refs.upload.submit()):e.doSubmit())}))}},{key:"doSubmit",value:function(){var e=Object(y["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.post(this.form.id?m["a"].updateDeviceStatus:m["a"].addDeviceStatus,S({deviceTypeId:this.id},this.form,{defaultStatus:void 0}));case 3:t=e.sent,a=t.data,i=a.status,s=a.message,i?(this.$message.success("操作成功"),this.getStatusList(),this.dialog=!1,this.defaultDialog=!1):this.$message.error(s);case 8:return e.prev=8,this.dialogLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[0,,8,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleDelete",value:function(e){var t=this;this.$confirm("确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.doDelete(e)}))}},{key:"doDelete",value:function(){var e=Object(y["a"])(regeneratorRuntime.mark((function e(t){var a,i,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(m["a"].deleteDeviceStatus+t.id);case 2:a=e.sent,i=a.data,s=i.status,o=i.message,s?(this.$message.success("操作成功"),this.getStatusList()):this.$message.error(o);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"customHttpRequest",value:function(e){var t=this,a=h["a"].createUploadForm(e.file);this.$http.post(e.action,a.formData,a.config).then((function(e){e.data.status?(t.form.styleImg=e.data.data.accessUrl,t.doSubmit()):(t.$message.error("图片上传失败"),t.dialogLoading=!1)})).catch((function(){t.dialogLoading=!1}))}},{key:"customChange",value:function(e,t){var a=Object(b["c"])(e.raw,{formatList:["png","jpg","jpeg"],maxKbSize:Object(b["a"])({value:500,unit:"KB"})}),i=a.status,s=a.message;i?(this.$set(this.form,"styleImg",e.url),this.$refs.defaultForm.validateField("styleImg",(function(){})),this.form.needUpload=!0):(this.$message.error(s),this.$refs.upload.handleRemove(e))}},{key:"handleRemoveIcon",value:function(){var e=this;this.form.styleImg="",this.$nextTick((function(){e.$refs.upload.clearFiles()}))}}]),t}(u["e"]);d["__decorate"]([Object(u["d"])({type:String})],k.prototype,"id",void 0),d["__decorate"]([Object(u["f"])("id")],k.prototype,"handleIdChange",null),k=d["__decorate"]([Object(u["a"])({})],k);var D=k,x=D,C=(a("3c42"),a("2877")),w=Object(C["a"])(x,f,g,!1,null,"3d39925f",null),$=w.exports,B=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.method="add",e.typeObject={name:"设备类型",url:"/device"},e.treeMessage={filterText:"",data:[],defaultProps:{children:"children",label:"name"}},e.basicForm={icons:[]},e.dialogBasicForm={icons:[]},e.dialogBasicFormRules={name:{required:!0,message:"请输入设备名称",trigger:"change"},code:{required:!0,message:"请输入设备编码",trigger:"change"}},e.typeTreeNodeDialog=!1,e.transferData={data:[],selected:[]},e.loading=!1,e.hasCustomRole=qTouch.getBaseTypeByCode("device"),e}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"created",value:function(){this.getTypeTreeData()}},{key:"getTypeTreeData",value:function(){var e=this,t=this;this.$http.get(m["a"].getTypeDetail+"/findTypeTree"+this.typeObject.url).then((function(a){if(a.data.status){var i=a.data.data;t.treeMessage.data=i||[],!e.basicForm.id&&i.length&&e.handleNodeClick(i[0])}else e.$message.error(a.data.message)}))}},{key:"handleNodeClick",value:function(e){this.basicForm=JSON.parse(JSON.stringify(e)),e.icon&&(this.basicForm.icons=[{name:"icon",url:this.basicForm.icon}])}},{key:"setFilterText",value:function(e){this.$refs.tree.filter(e)}},{key:"filterNode",value:function(e,t){return!e||-1!==t[this.treeMessage.defaultProps.label].indexOf(e)}},{key:"openTypeTreeNodeForm",value:function(e,t){var a=this;switch(e){case"add":this.method="add",this.dialogBasicForm={icons:[]},this.dialogBasicForm.parentId=t.id,this.dialogBasicForm.level=t.level+1;break;case"edit":this.method="edit",this.dialogBasicForm=Object.assign({},t),t.icon&&(this.dialogBasicForm.icons=[{name:"icon",url:t.icon}]);break;case"addTop":this.method="add",this.dialogBasicForm={},this.dialogBasicForm.level=1;break}this.typeTreeNodeDialog=!0,this.$nextTick((function(){a.$refs.dialogBasicForm.clearValidate()})),this.getTypeAndAttrs()}},{key:"remove",value:function(e,t){var a=this;this.$confirm("删除该类型将会删除其所有子类型及下属数据，是否删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$http.get(m["a"].deleteType+"/"+t.id).then((function(e){e.data.status?(a.$message.success("删除成功"),a.getTypeTreeData()):a.$message.error(e.data.message)}))}))}},{key:"getTypeAndAttrs",value:function(){var e=this,t=this;this.$http.get(m["a"].getTypeDetail+"/attr/transferData"+this.typeObject.url,{params:{typeDetailId:this.dialogBasicForm.id}}).then((function(a){if(a.data.status){var i=a.data.data;t.transferData.data=[],i.data.forEach((function(e){t.transferData.data.push({key:e.id,label:e.attrName})})),t.transferData.selected=i.selected}else e.$message.error(a.data.message)}))}},{key:"saveTypeAndAttr",value:function(){var e=this;this.$refs.dialogBasicForm.validate((function(t){if(t){e.loading=!0;var a=m["a"].getTypeDetail+"/addTypeAndAttrs"+e.typeObject.url;"edit"==e.method&&(a=m["a"].getTypeDetail+"/updateTypeAndAttrs"+e.typeObject.url);var i=e.dialogBasicForm;e.dialogBasicForm.icons&&e.dialogBasicForm.icons.length?i.icon=e.dialogBasicForm.icons[0].url?e.dialogBasicForm.icons[0].url:"":i.icon="",i.attrs=e.transferData.selected,e.$http.post(a,i).then((function(t){e.loading=!1,t.data.status?(e.$message.success("操作成功"),e.typeTreeNodeDialog=!1,e.getTypeTreeData(),e.basicForm=t.data.data,e.$refs["baseDataInfoTable"].getCustomAttributeList()):e.$message.error(t.data.message)})).catch((function(){e.loading=!1}))}}))}}]),t}(u["e"]);d["__decorate"]([Object(u["f"])("treeMessage.filterText")],B.prototype,"setFilterText",null),B=d["__decorate"]([Object(u["a"])({components:{DeviceStatusList:$},filters:{formatterAttrType:p["a"]}})],B);var F=B,O=F,I=(a("9a75"),Object(C["a"])(O,i,s,!1,null,"6c0bce7f",null));t["default"]=I.exports},da12:function(e,t,a){},ef0f:function(e,t,a){"use strict";var i="/admin/device/",s={getPaging:"/admin/device/pagingDevice",add:"/admin/device/add",update:"/admin/device/update",delete:"/admin/device/delete",multipleDelete:"/admin/device/multipleDelete",getNewOrgTree:"/admin/organization/orgTree/device",getOneById:"/admin/device/getOneById",addCondition:"/admin/device/condition/add",updateCondition:"/admin/device/condition/update",deleteCondition:"/admin/device/condition/delete/",getConditionList:"/admin/device/condition/listByDeviceId/",updateConditionItem:"/admin/device/condition/item/update/deviceConditionId/",getDeviceStatusList:"/admin/device/status/listByDeviceId/",updateDeviceStatusStyle:"/admin/device/status/updateStyle/deviceStatusId/",addDeviceStatusConditions:"/admin/device/status/condition/addDeviceStatusConditions/",getDeviceTypeTree:"/admin/typeDetail/findTypeTree/device",classifyTree:i+"classify/list",addClassify:i+"classify/add",updateClassify:i+"classify/update",deleteClassify:i+"classify/delete/",getClaasifyDeviceList:i+"classify/relation/bindingInfo/classifyId/",listNotBindByClassifyId:i+"classify/relation/listNotBindByClassifyId/classifyId/",classifyBind:i+"classify/relation/bind",classifyUnbind:i+"classify/relation/unbind/relationId/",multipleDeleteDevice:"/admin/device/multipleDelete",deleteOneDevice:"/admin/device/",getOneDevice:i+"getOneById/",addDeviceInfo:i+"add",updateDeviceInfo:i+"update",deviceBindSensor:i+"sensor/bind/deviceId/",getBindSensor:i+"sensor/listSensorByDeviceId/deviceId/",deleteBindSensor:i+"sensor/unbind",getSensorPage:"/admin/sensor/paging",getSensorAttr:"/admin/sensor/attribute/listBySensorId/",getEventDefinition:"/admin/event/definition/paging",findTypeTree:"/admin/typeDetail/findTypeTree",getTemplateByTypeDetaiId:"/admin/typeDetail/getTemplateByTypeDetaiId",getTypeDetail:"/admin/typeDetail",deleteType:"/admin/typeDetail/delete",saveCustomAttrItems:"/admin/typeDetail/saveCustomAttrItems",sensorHistory:"/admin/sensor/deviceSensorDataToChart/",getCurrentData:"/admin/sensor/deviceCurrentSensorDataToChart/",getTimeQuantumData:"/admin/sensor/staticDeviceSensorDataToChart",getDeviceTypeStatusList:"/admin/deviceStatusDefinition/listByDeviceTypeId/",addDeviceStatus:"/admin/deviceStatusDefinition/add",updateDeviceStatus:"/admin/deviceStatusDefinition/update",deleteDeviceStatus:"/admin/deviceStatusDefinition/delete/",getStatusInfoByStatusId:"/admin/deviceStatusDefinition/getInfoByStatusId/",getDeviceAlarmRecord:"/admin/device/terms/getWarningRecords",listWarningTerms:"/admin/device/terms/listWarningTerms/",addStatusRule:"/admin/device/terms/addStatusRule",updateStatusRule:"/admin/device/terms/updateStatusRule",deleteByWarningTermId:"/admin/device/terms/deleteByWarningTermId/",getAccessStatus:"/admin/device/terms/getAccessStatus/",getPersonPaging:"/admin/person/pagingMessagePerson",getRoleList:"/admin/role/list",listEventTerms:"/admin/device/terms/listEventTerms/",addEventRule:"/admin/device/terms/addEventRule",updateEventRule:"/admin/device/terms/updateEventsRule",deleteByEventTermId:"/admin/device/terms/deleteByEventTermId/",checkExpression:"/admin/device/terms/checkRule",download:"/api/excel/download/deviceTemplate",upload:"/api/excel/upload/deviceTemplate"};t["a"]=s}}]);
//# sourceMappingURL=chunk-2c8d11f4.3e0b0b81.js.map