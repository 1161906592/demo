(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-16a772e4"],{"17e4":function(e,t,a){},3251:function(e,t,a){"use strict";var s={getUserTasks:"/admin/processInstance/getUserTasks",getProcessParameter:"/admin/processInstance/getProcessParameter",handleTask:"/admin/processInstance/handleTask",getProcessImg:"/admin/processInstance/getProcessImg",getProcessDetailInfo:"/admin/processhistory/getHisProcComment/",getApplyFormValue:"/admin/processhistory/getSumbitValue/",getOngoingProcess:"/admin/processhistory/getMyUnFinishedProcess",getFinishedProcess:"/admin/processhistory/getMyFinishedProcess",getEventType:"/api/eventType/getEventType",getAllProcessType:"/admin/processType/procdeftype/findAll",processAssignState:"/admin/processDesigner/public/process/processAssignState",getAllProcessList:"/admin/processDesigner/public/visible/getAllProcessByUserVisible",getFormDefine:"/admin/formdesigner/getFormDefine",getAllUserVisible:"/admin/processDesigner/public/visible/getAllUser",getAssignTaskList:"/admin/processDesigner/public/process/getAssignTaskList",getAllOrg:"/admin/processDesigner/public/visible/getAllOrg",getAllRole:"/admin/processDesigner/public/visible/getAllRole",getAllUser:"/admin/processDesigner/public/visible/getAllUser",getFormList:"/admin/formdesigner/getFormList",saveSubmitForm:"/admin/processInstance/saveSubmitForm",getProcessInstance:"/admin/processInstance/getProcessInstance",getAllClosedProcess:"/admin/processhistory/getCompleteProcess",getRuntimeTaskAssignedList:"/admin/processInstance/getRuntimeTaskAssignedList",updateAssignedGroup:"/admin/processInstance/updateAssignedGroup"};t["a"]=s},"581e":function(e,t,a){"use strict";var s=a("eb79"),r=a.n(s);r.a},a7c9:function(e,t,a){"use strict";var s=a("17e4"),r=a.n(s);r.a},b568:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"search-box"},[a("el-input",{staticStyle:{width:"240px"},attrs:{size:"small",placeholder:"关键字查询"},model:{value:e.queryCriteria.procdefName,callback:function(t){e.$set(e.queryCriteria,"procdefName",t)},expression:"queryCriteria.procdefName"}}),a("el-select",{staticStyle:{width:"240px","margin-left":"20px"},attrs:{size:"small",placeholder:"请选择流程类型",clearable:""},on:{change:e.getTableData},model:{value:e.queryCriteria.typeId,callback:function(t){e.$set(e.queryCriteria,"typeId",t)},expression:"queryCriteria.typeId"}},e._l(e.typeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.procdefTypeName,value:e.id}})})),1),a("q-search-button",{staticStyle:{"margin-left":"10px"},on:{click:e.getTableData}})],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"process-box"},[a("el-table",{staticStyle:{"text-align":"center","min-height":"calc(100vh - 294px)"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{align:"center",prop:"id",label:"序号",type:"index",width:"100"}}),a("el-table-column",{attrs:{prop:"procdef_name",label:"流程名称"}}),a("el-table-column",{attrs:{prop:"procdef_key",label:"流程标识"}}),a("el-table-column",{attrs:{prop:"updateTime",label:"修改日期",formatter:function(t){return e.$moment(t.update_time).format("YYYY-MM-DD HH:mm:ss")}}}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",title:"编辑"},on:{click:function(a){return e.getProcessDetail(t.row)}}},[e._v("\n            发起流程\n          ")])]}}])})],1)],1),a("q-pagination",{attrs:{"current-page":e.queryCriteria.pageNum,"page-size":e.queryCriteria.pageSize,total:e.total},on:{"current-change":e.getTableData,"update:currentPage":function(t){return e.$set(e.queryCriteria,"pageNum",t)},"update:current-page":function(t){return e.$set(e.queryCriteria,"pageNum",t)}}}),a("el-dialog",{staticClass:"initiation-dialog",attrs:{title:"发起流程",visible:e.showInitiationDialog,width:"1000px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.showInitiationDialog=t}}},[a("q-custom-input",{ref:"customInput",attrs:{"custom-options":e.formDefine,"line-size":2}}),a("el-form",{attrs:{"label-width":"130px"},model:{value:e.processForm,callback:function(t){e.processForm=t},expression:"processForm"}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注：",prop:"taskRemark"}},[a("el-input",{attrs:{size:"small",autosize:{minRows:2,maxRows:4},type:"textarea"},model:{value:e.processForm.taskRemark,callback:function(t){e.$set(e.processForm,"taskRemark",t)},expression:"processForm.taskRemark"}})],1)],1),a("el-col",{attrs:{span:12}},[e._e()],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showInitiationDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.InitiationProcess}},[e._v("发起流程")])],1)],1)],1)},r=[],i=(a("ac6a"),a("96cf"),a("3b8d")),n=a("d225"),o=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),m=a("9ab4"),p=a("60a3"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form-item",{attrs:{label:e.formItem.name+"："}},["text"===e.formItem.attrType?a("el-input",{staticStyle:{"max-width":"300px"},attrs:{size:"small",value:e.formItem.value,disabled:e.isDisable},on:{input:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}}):"textarea"===e.formItem.attrType?a("el-input",{staticStyle:{"max-width":"500px"},attrs:{size:"small",type:"textarea",value:e.formItem.value,disabled:e.isDisable},on:{input:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}}):"checkbox"===e.formItem.attrType?a("el-checkbox-group",{staticStyle:{"max-width":"500px"},attrs:{size:"small",disabled:e.isDisable},on:{change:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}},e._l(e.formItem.options,(function(t){return a("el-checkbox-button",{key:t,attrs:{label:t}},[e._v("\n      "+e._s(t)+"\n    ")])})),1):"select"===e.formItem.attrType?a("el-select",{staticStyle:{"max-width":"300px"},attrs:{size:"small",placeholder:"请选择",disabled:e.isDisable},on:{change:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}},e._l(e.formItem.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1):"number"===e.formItem.attrType?a("el-input-number",{staticStyle:{"max-width":"300px"},attrs:{size:"small",disabled:e.isDisable},on:{change:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}}):"datetime"===e.formItem.attrType?a("el-date-picker",{staticStyle:{"max-width":"300px"},attrs:{size:"small",type:"date",placeholder:"选择日期时间","value-format":"yyyy-MM-dd",disabled:e.isDisable},on:{change:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}}):"time"===e.formItem.attrType?a("el-time-picker",{staticStyle:{"max-width":"300px"},attrs:{size:"small",placeholder:"选择时间",format:"HH:mm","value-format":"HH:mm",disabled:e.isDisable},on:{change:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}}):"upload"===e.formItem.attrType?a("el-upload",{staticClass:"upload-demo",staticStyle:{"max-width":"300px"},attrs:{size:"small",action:"/","auto-upload":!1,name:"file",disabled:""}},[a("el-button",{attrs:{size:"small",type:"primary",disabled:e.isDisable}},[e._v("点击上传")]),a("div",{attrs:{slot:"tip"},slot:"tip"},[e._v("\n      上传文件\n    ")])],1):"img"===e.formItem.attrType?a("q-upload",{attrs:{limitNum:e.formItem.dataRange.imgMaxNum,accept:"image/bmp,image/png,image/jpeg",disabled:e.disabled},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}},[!e.disabled||e.formItem.value&&"[]"!==e.formItem.value&&e.formItem.value!==[]?e._e():a("template",{slot:"middle"},[e._v("\n      未上传图片\n    ")])],2):"position"===e.formItem.type?a("el-input",{staticStyle:{width:"280px"},attrs:{size:"small",placeholder:"选择坐标",disabled:e.isDisable},on:{input:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}}):"position"===e.formItem.type?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",icon:"el-icon-location",disabled:e.isDisable}}):"url"!==e.formItem.type||e.isDisable?"url"===e.formItem.type&&e.isDisable?a("a",{attrs:{href:"https://"+e.formItem.value,target:"_blank"}},[e._v("\n    点击查看详情\n  ")]):a("div",[e._v("\n    "+e._s(e.formItem.value)+"\n  ")]):a("el-input",{staticStyle:{"max-width":"300px"},attrs:{size:"small",value:e.formItem.value},on:{input:function(t){return e.$emit("edit",t)}},model:{value:e.formItem.value,callback:function(t){e.$set(e.formItem,"value",t)},expression:"formItem.value"}},[a("template",{slot:"prepend"},[e._v("\n      Http://\n    ")])],2)],1)},f=[],g=a("3251"),h=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.eventOptions=[],e.prop={value:"id",label:"eventTypeName"},e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"getEventType",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(g["a"].getEventType,{params:{orgId:0}});case 2:t=e.sent,a=t.data,s=a.data,r=a.status,i=a.message,r?this.eventOptions=s.detail:this.$message.error(i);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){console.log(this.formItem)}}]),t}(p["e"]);m["__decorate"]([Object(p["d"])({type:Object,default:function(){}})],h.prototype,"formItem",void 0),m["__decorate"]([Object(p["d"])({type:Boolean,default:!1,required:!1})],h.prototype,"isDisable",void 0),h=m["__decorate"]([Object(p["a"])({})],h);var v=h,b=v,y=(a("a7c9"),a("2877")),I=Object(y["a"])(b,d,f,!1,null,"4d1d436f",null),k=I.exports,x=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.queryCriteria={procdefName:"",pageSize:10,pageNum:1,typeId:""},e.total=0,e.typeOptions=[],e.tableData=[],e.loading=!1,e.showInitiationDialog=!1,e.showJudgeTable=!1,e.judgeTableLoading=!0,e.formDefine=[],e.processForm={},e.assignList=[],e.userInfoList=[],e.orgValue=[],e.invisibleOrgList=[],e.userValue=[],e.invisibleUserList=[],e.roleValue=[],e.invisibleRoleList=[],e.formList=[],e.currentData=null,e.searchFormName="",e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){this.getAllProcessType(),this.getTableData()}},{key:"getAllProcessType",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$http.get(g["a"].getAllProcessType);case 4:t=e.sent,a=t.data,s=a.data,r=a.status,i=a.message,r?this.typeOptions=s:this.$message.error(i);case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,,10,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTableData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$http.get(g["a"].getAllProcessList,{params:this.queryCriteria});case 4:t=e.sent,a=t.data,s=a.data,r=a.status,i=a.message,r?(this.tableData=s.records,this.total=s.total):this.$message.error(i);case 10:return e.prev=10,this.loading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,,10,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getProcessDetail",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,s,r,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.currentData=t,this.judgeAssignState(t),e.prev=2,e.next=5,this.$http.get(g["a"].getFormDefine,{params:{formId:t.form_id}});case 5:a=e.sent,s=a.data,r=s.data,i=s.status,n=s.message,i?(this.formDefine=JSON.parse(r.formDef),this.showInitiationDialog=!0):this.$message.error(n);case 11:return e.prev=11,e.finish(11);case 14:this.getProcessVisibleOrg(),this.getProcessVisibleRole(),this.getProcessVisiblePerson(),this.getAllFormList();case 18:case"end":return e.stop()}}),e,this,[[2,,11,14]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"judgeAssignState",value:function(e){var t=this;this.$http.get(g["a"].processAssignState,{params:{procdefKey:e.procdef_key}}).then((function(a){a.data.status?(t.showJudgeTable=a.data.data,a.data.data||t.getAssignTaskList(e)):t.$message.error(a.data.message)}))}},{key:"findUserByName",value:function(e){var t=this;this.$http.get(g["a"].getAllUserVisible,{params:{userName:e}}).then((function(e){e.data.status?t.userInfoList=e.data.data:t.$message.error(e.data.message)}))}},{key:"getAssignTaskList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$http.get(g["a"].getAssignTaskList,{params:{processDefineId:t.procdef_id}}).then((function(e){e.data.status?(e.data.data.shift(),e.data.data.forEach((function(e){var t=e.userInfoVOS;t&&(e.userId=e.isCountersign?t.map((function(e){return e.userId})):t[0].userId);var a=e.orgVO;a&&(e.orgId=a.orgId);var s=e.roleVO;s&&(e.roleId=s.roleId)})),a.assignList=e.data.data,a.judgeTableLoading=!1):a.$message.error(e.data.message)}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getProcessVisibleOrg",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(g["a"].getAllOrg,{params:{procdefKey:this.currentData.procdef_key}});case 2:t=e.sent,a=t.data,s=a.data,r=a.status,i=a.message,r?this.invisibleOrgList=s:this.$message.error(i);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getProcessVisibleRole",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(g["a"].getAllRole,{params:{procdefKey:this.currentData.procdef_key}});case 2:t=e.sent,a=t.data,s=a.data,r=a.status,i=a.message,r?this.invisibleRoleList=s:this.$message.error(i);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getProcessVisiblePerson",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(g["a"].getAllUser,{params:{procdefKey:this.currentData.procdef_key}});case 2:t=e.sent,a=t.data,s=a.data,r=a.status,i=a.message,r?this.invisibleUserList=s:this.$message.error(i);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getAllFormList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(g["a"].getFormList,{params:{formName:this.searchFormName,size:999999,current:1}});case 2:t=e.sent,a=t.data,s=a.data,r=a.status,i=a.message,r?this.formList=s.records:this.$message.error(i);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"InitiationProcess",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.customInput.formValidation();case 2:t=e.sent,t&&(a=this.assignList.map((function(e){var t=e.userId;return Array.isArray(t)||(t=[t]),{formId:e.formId,processDefineId:s.currentData.procdefId,userTaskId:e.userTask.id,userInfoId:t,roleId:e.roleId,orgId:e.orgId}})),this.$http.post(g["a"].saveSubmitForm,{assignMap:a,formSubmitValue:JSON.stringify(this.formDefine),procdefKey:this.currentData.procdef_key,targetUserIds:this.processForm.targetUserIds,taskRemark:this.processForm.taskRemark?this.processForm.taskRemark:""}).then((function(e){e.data.status?(s.$message.success("流程发起成功"),s.showInitiationDialog=!1):s.$message.error(e.data.message)})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(p["e"]);x=m["__decorate"]([Object(p["a"])({components:{FormDefines:k}})],x);var w=x,D=w,$=(a("581e"),Object(y["a"])(D,s,r,!1,null,"41fcc44c",null));t["default"]=$.exports},eb79:function(e,t,a){}}]);
//# sourceMappingURL=chunk-16a772e4.929b653b.js.map