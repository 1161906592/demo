(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-47729500"],{"506d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("q-left-right-layout",{staticStyle:{width:"100%"},attrs:{"left-title":"组织机构类型","right-title":(e.basicForm.name?e.basicForm.name:"类型")+"详情","btn-tip":"添加一级菜单"},on:{click:function(t){return e.openTypeTreeNodeForm("addTop","")}}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("el-input",{staticClass:"inpW",attrs:{placeholder:"输入关键字进行过滤",maxlength:100,size:"small"},model:{value:e.treeMessage.filterText,callback:function(t){e.$set(e.treeMessage,"filterText",t)},expression:"treeMessage.filterText"}}),a("div",{staticClass:"tree-body"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.treeMessage.data,props:e.treeMessage.defaultProps,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticStyle:{display:"inline-block","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","word-break":"keep-all"},style:{width:190-18*(i.treeLevel-1)+"px"},attrs:{title:i.label}},[e._v("\n              "+e._s(i.label)+"\n            ")]),a("span",[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus",title:"添加子节点"},on:{click:function(t){return e.openTypeTreeNodeForm("add",s)}}}),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit",title:"编辑节点"},on:{click:function(t){return e.openTypeTreeNodeForm("edit",s)}}}),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete",title:"删除节点"},on:{click:function(t){return e.remove(i,s)}}})],1)])}}])})],1)],1),a("div",{staticClass:"right-content",attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"basic-attribute"},[a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu icon-blue"}),e._v("基础信息")]),a("div",{staticClass:"basic-attribute-body"},[a("el-form",{ref:"",attrs:{"label-width":"100px",size:"mini","status-icon":"",model:e.basicForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"名称：",prop:"name"}},[a("el-input",{staticClass:"el-input-refact",attrs:{size:"small",disabled:""},model:{value:e.basicForm.name,callback:function(t){e.$set(e.basicForm,"name",t)},expression:"basicForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"父节点名称："}},[a("el-input",{staticClass:"el-input-refact",attrs:{size:"small",disabled:""},model:{value:e.basicForm.parentName,callback:function(t){e.$set(e.basicForm,"parentName",t)},expression:"basicForm.parentName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"编号：",prop:"code"}},[a("el-input",{staticClass:"el-input-refact",attrs:{size:"small",disabled:""},model:{value:e.basicForm.code,callback:function(t){e.$set(e.basicForm,"code",t)},expression:"basicForm.code"}})],1)],1)],1)],1)],1),a("el-divider")],1),e.hasCustomRole?a("div",{staticClass:"basic-attribute"},[a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu icon-blue"}),e._v("自定义信息")]),a("base-data-info-table",{ref:"baseDataInfoTable",attrs:{id:e.basicForm.id,active:"/admin/typeDetail/attr/pagingAttr/organization/"}})],1):e._e()])]),a("add-org-prop",{attrs:{dialogTitle:e.dialogTitle,dialogVisible:e.visibleDialog,data:e.formData},on:{close:e.closeDialog,submit:e.saveTypeAndAttr}})],1)},s=[],o=a("d225"),r=a("b0b4"),l=a("308d"),n=a("6bb5"),d=a("4e2b"),c=a("9ab4"),u=a("60a3"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.addDialog,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.addDialog=t},close:e.closeDialog}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"addForm",attrs:{size:"small","label-width":"100px",model:e.addForm,rules:e.formRules}},[a("el-form-item",{attrs:{label:"类型名称：",prop:"name"}},[a("el-input",{attrs:{maxlength:100,placeholder:"请输入",clearable:""},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),a("el-form-item",{attrs:{label:"类型编码：",prop:"code"}},[a("el-input",{attrs:{maxlength:100,placeholder:"包含字母、数字、横线、下划线和点,点不能作为开头,长度3-100位",clearable:""},model:{value:e.addForm.code,callback:function(t){e.$set(e.addForm,"code",t)},expression:"addForm.code"}})],1),a("div",{staticStyle:{"margin-left":"20px"}},[e.hasCustomRole?a("el-transfer",{attrs:{filterable:"",titles:["未选择","已选择"],"button-texts":["解绑","绑定"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:e.transferData.data},model:{value:e.transferData.selected,callback:function(t){e.$set(e.transferData,"selected",t)},expression:"transferData.selected"}}):e._e()],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.closeDialog}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.saveSensorAttribute()}}},[e._v("确定")])],1)],1)],1)},p=[],g=(a("ac6a"),a("dcd8")),f=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.hasCustomRole=qTouch.getBaseTypeByCode("organization"),e.addDialog=!1,e.addForm={id:"",name:"",code:""},e.loading=!1,e.formRules={name:{required:!0,trigger:"blur",message:"请输入名称"},code:{required:!0,trigger:"blur",message:"请输入编码"}},e.transferData={data:[],selected:[]},e}return Object(d["a"])(t,e),Object(r["a"])(t,[{key:"handleVisible",value:function(e){var t=this;this.addDialog=e,e&&this.$nextTick((function(){var e=t.$refs.addForm;e.resetFields(),t.addForm=JSON.parse(JSON.stringify(t.data)),t.getTypeAndAttrs()}))}},{key:"closeDialog",value:function(){this.addDialog=!1,this.$emit("close")}},{key:"saveSensorAttribute",value:function(){var e=this,t=this.$refs.addForm;t.validate((function(t){if(!t)return!1;e.loading=!0;var a=e.addForm.id?g["a"].getTypeDetail+"/updateTypeAndAttrs/organization":g["a"].getTypeDetail+"/addTypeAndAttrs/organization",i=Object.assign(e.addForm,{attrs:e.transferData.selected});e.$http.post(a,i).then((function(t){e.loading=!1,t.data.status?(e.$message.success("操作成功"),e.addDialog=!1,e.$emit("submit",t.data.data)):e.$message.error(t.data.message)})).catch((function(){e.loading=!1}))}))}},{key:"getTypeAndAttrs",value:function(){var e=this,t=this;this.$http.get(g["a"].getTypeDetail+"/attr/transferData/organization?typeDetailId="+this.addForm.id).then((function(a){if(a.status)if(a.data.status){var i=a.data.data;t.transferData.data=[],i.data.forEach((function(e){t.transferData.data.push({key:e.id,label:e.attrName})})),t.transferData.selected=i.selected}else e.$message.error(a.data.message)}))}}]),t}(u["e"]);c["__decorate"]([Object(u["d"])({type:String,default:"添加组织机构类型"})],f.prototype,"dialogTitle",void 0),c["__decorate"]([Object(u["d"])({type:Boolean,default:!1})],f.prototype,"dialogVisible",void 0),c["__decorate"]([Object(u["d"])({type:Object,default:function(){return{}}})],f.prototype,"data",void 0),c["__decorate"]([Object(u["f"])("dialogVisible")],f.prototype,"handleVisible",null),f=c["__decorate"]([Object(u["a"])({components:{}})],f);var b=f,h=b,y=(a("addaa"),a("2877")),v=Object(y["a"])(h,m,p,!1,null,"2a951a48",null),T=v.exports,D=a("0933"),k=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.treeMessage={filterText:"",data:[],defaultProps:{children:"children",label:"name"}},e.basicForm={name:""},e.pagination={condition:"",currentPage:1,total:0,tableData:[],pageSize:10},e.dialogTitle="",e.visibleDialog=!1,e.formData={id:"",name:"",code:""},e.mode="add",e.hasCustomRole=qTouch.getBaseTypeByCode("organization"),e}return Object(d["a"])(t,e),Object(r["a"])(t,[{key:"created",value:function(){this.getTypeTreeData()}},{key:"getTypeTreeData",value:function(){var e=this;this.$http.get(g["a"].getTypeDetail+"/findTypeTree/organization").then((function(t){if(t.status)if(t.data.status){var a=t.data.data;e.treeMessage.data=a||[],e.basicForm.id||e.handleNodeClick(e.treeMessage.data[0])}else e.$message.error(t.data.message)}))}},{key:"handleNodeClick",value:function(e){this.basicForm=Object.assign({},e)}},{key:"setFilterText",value:function(e){this.$refs.tree.filter(e)}},{key:"filterNode",value:function(e,t){return!e||-1!==t[this.treeMessage.defaultProps.label].indexOf(e)}},{key:"openTypeTreeNodeForm",value:function(e,t){switch(e){case"add":this.dialogTitle="添加组织机构类型",this.formData={parentId:t.id,treeLevel:t.treeLevel+1};break;case"edit":this.dialogTitle="编辑组织机构类型",this.formData=Object.assign({},t);break;case"addTop":this.dialogTitle="添加组织机构类型",this.formData={treeLevel:1};break}this.mode=e,this.visibleDialog=!0}},{key:"remove",value:function(e,t){var a=this;this.$confirm("删除该类型将会删除其所有子类型及下属数据，是否删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$http.get(g["a"].deleteType+"/"+t.id).then((function(e){e.status&&(e.data.status?(a.$message.success("操作成功"),t.id===a.basicForm.id&&(a.basicForm.id=null),a.getTypeTreeData()):a.$message({showClose:!0,message:e.data.message,type:"error"}))}))}))}},{key:"saveTypeAndAttr",value:function(e){this.visibleDialog=!1,this.basicForm=Object.assign({},e),this.getTypeTreeData(),"edit"===this.mode&&this.$refs["baseDataInfoTable"].getCustomAttributeList()}},{key:"closeDialog",value:function(){this.visibleDialog=!1}}]),t}(u["e"]);c["__decorate"]([Object(u["f"])("treeMessage.filterText")],k.prototype,"setFilterText",null),k=c["__decorate"]([Object(u["a"])({filters:{formatterAttrType:D["a"]},components:{AddOrgProp:T}})],k);var F=k,x=F,O=(a("d050"),Object(y["a"])(x,i,s,!1,null,"114fcd73",null));t["default"]=O.exports},a002:function(e,t,a){},addaa:function(e,t,a){"use strict";var i=a("a002"),s=a.n(i);s.a},ca75:function(e,t,a){},d050:function(e,t,a){"use strict";var i=a("ca75"),s=a.n(i);s.a},dcd8:function(e,t,a){"use strict";var i={getBaseTypeList:"/admin/baseType/list",getTypeDetail:"/admin/typeDetail",findTypeTree:"/admin/typeDetail/findTypeTree",getTemplateByTypeDetaiId:"/admin/typeDetail/getTemplateByTypeDetaiId",getTreeData:"/admin/typeDetail/findTypeTree/organization",getAttrList:"/admin/typeDetail/attr/pagingAttr/organization",getTypeAndAttrs:"/admin/typeDetail/attr/transferData/organization",saveOrUpdateTypeAndAttrs:"/admin/typeDetail/saveOrUpdateTypeAndAttrs/organization",saveCustomAttrItems:"/admin/typeDetail/saveCustomAttrItems",deleteType:"/admin/typeDetail/delete",getOrgTreeData:"/admin/organization/orgTree",getOrgInfo:"/admin/organization/getOrgDetailById",addOrgBaseInfo:"/admin/organization/add",updateOrgBaseInfo:"/admin/organization/update",saveOrgAccess:"/admin/organization/saveOrgAccess",delete:"/admin/organization/delete",download:"/api/excel/download/orgTemplate",upload:"/api/excel/upload/orgTemplate"};t["a"]=i}}]);
//# sourceMappingURL=chunk-47729500.088bd28e.js.map