(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["micro_navBar"]=t():e["micro_navBar"]=t()})(window,(function(){return function(e){function t(t){for(var n,s,c=t[0],i=t[1],u=t[2],d=0,h=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&h.push(o[s][0]),o[s]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);l&&l(t);while(h.length)h.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,c=1;c<a.length;c++){var i=a[c];0!==o[i]&&(n=!1)}n&&(r.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},o={navBar:0},r=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/microApp/";var c=window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=i;return r.push([12,"chunk-vendors","chunk-common"]),a()}({12:function(e,t,a){e.exports=a("2936")},2293:function(e,t,a){"use strict";var n={getAccountInfo:"/admin/account/getAccountInfo",updateBaseUserInfo:"/admin/account/updateAccount",changeUserName:"/admin/account/updateAccountName",updatePassword:"/admin/account/updateAccountPassword",updatePhoto:"/admin/person/updatePhoto",toolBar:{getUserTools:"/admin/map/data/location/menu",getSystemTools:"/admin/map/system/toolbar/get"},mapStyle:"/admin/map/custom/style/get",chartsList:"/admin/map/custom/chart/list",findTypeTree:"/admin/typeDetail/findTypeTree",getMarkerData:"/admin/map/data/location/get",getTypeTree:"/admin/map/data/location/system/menu",getDetail:{device:"/admin/device/getOneById/",building:"/admin/building/getOneById/",car:"/admin/car/get/",person:"/admin/person/getPersonById?personId="},getAllEvent:"/admin/map/data/location/device/warn",getTenantInfo:"/admin/tenant/current/info"};t["a"]=n},2936:function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var n=a("2b0e"),o=a("7038"),r=a.n(o),s=a("8c4f"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"nav-bar"}},[a("aside",{staticClass:"aside",class:{fullscreen:e.fullscreen}},[a("div",{staticClass:"logo"}),a("div",{staticClass:"menu-container"},[a("div",{staticClass:"menu-scroll"},[a("el-menu",{ref:"elMenu",staticClass:"menu",attrs:{"background-color":"#373737","text-color":"#999A9F","default-active":e.defaultActive,"unique-opened":""},on:{select:e.handleSelectMenu}},[a("q-menu",{attrs:{data:e.menuData},on:{select:e.handleSelect}})],1)],1)])]),a("header",{staticClass:"header",class:{fullscreen:e.fullscreen}},[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"left"},[a("div",{staticClass:"collapse"},[e.fullscreen?a("i",{staticClass:"el-icon-s-unfold",on:{click:e.handleUnFoldMenu}}):a("i",{staticClass:"el-icon-s-fold",on:{click:e.handleFoldMenu}})]),a("div",{staticClass:"current-team"},[a("span",[e._v("当前：")]),a("el-select",{staticClass:"navbar-team-name",attrs:{size:"small"},on:{change:e.changeTeam},model:{value:e.currentTeam,callback:function(t){e.currentTeam=t},expression:"currentTeam"}},e._l(e.teamList,(function(e){return a("el-option",{key:e.tenantId,attrs:{value:e.tenantId,label:e.tenantName}})})),1)],1)]),a("div",{staticClass:"right"},[a("el-popover",{attrs:{placement:"bottom-end",width:"146",trigger:"hover"}},[a("div",{staticClass:"popover-wrap"},[a("div",{staticClass:"popover-item",on:{click:function(t){return e.goPersonInfo("/personInfo")}}},[e._v("修改个人信息")]),a("div",{staticClass:"popover-item",on:{click:function(t){return e.goPersonInfo("/changePass")}}},[e._v("修改密码")]),a("div",{staticClass:"popover-item",on:{click:e.logout}},[e._v("退出登录")])]),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("span",{staticClass:"realName"},[e._v("欢迎您， "+e._s(e.realName))]),a("i",{staticClass:"el-icon-caret-bottom"})])])],1)]),a("div",{staticClass:"location"},[e._v("\n      当前位置：\n      "),a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticStyle:{cursor:"pointer"},nativeOn:{click:function(t){return e.handleToRoot(t)}}},[e._v("首页")]),e._l(e.locationInfo,(function(t,n){return a("el-breadcrumb-item",{key:n},[e._v(e._s(t))])}))],2)],1)]),a("router-view",{staticClass:"app-container"})],1)},i=[],u=(a("8615"),a("6762"),a("2fdb"),a("3b2b"),a("4917"),a("f559"),a("7f7f"),a("7514"),a("ac6a"),a("96cf"),a("3b8d")),l=(a("28a5"),a("d225")),d=a("b0b4"),h=a("308d"),f=a("6bb5"),p=a("4e2b"),m=a("9ab4"),g=a("60a3"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.data,(function(t){return[t.children&&t.children.length?a("submenu",{key:t.id,attrs:{index:t.path||""}},[a("template",{slot:"title"},[a("i",{class:"font_family "+t.icon}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(t.name))])]),a("q-menu",{attrs:{data:t.children},on:{select:e.handleSelect}})],2):a("menu-item",{key:t.id,attrs:{index:t.path||""},nativeOn:{click:function(a){return e.handleSelect(t)}}},[a("i",{class:"font_family "+t.icon}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(t.name))])])]}))],2)},b=[],y=(a("8bd8"),a("450d"),a("4cb2")),T=a.n(y),w=(a("ce18"),a("f58e")),k=a.n(w),_=function(e){function t(){return Object(l["a"])(this,t),Object(h["a"])(this,Object(f["a"])(t).apply(this,arguments))}return Object(p["a"])(t,e),Object(d["a"])(t,[{key:"handleSelect",value:function(e){this.$emit("select",e)}}]),t}(g["e"]);m["__decorate"]([Object(g["d"])({type:Array,required:!0})],_.prototype,"data",void 0),_=m["__decorate"]([Object(g["a"])({name:"QMenu",components:{Submenu:k.a,MenuItem:T.a}})],_);var I,P=_,S=P,O=a("2877"),q=Object(O["a"])(S,v,b,!1,null,null,null),M=q.exports,j={logout:"/api/user/logout",getTeamList:"/api/tenant/change/getTenants",changeTeam:"/api/tenant/change/changeTenant"},C=j,x=a("c195"),N=a("73ec"),A=a("2293"),L=I=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(h["a"])(this,Object(f["a"])(t).apply(this,arguments)),e.menuData=[],e.hashMap={},e.realName=localStorage.getItem("realName")||"",e.defaultActive=location.href.split(location.origin+qTouch.basePath)[1]||"",e.fullscreen=!1,e.locationInfo=[],e.currentTeam="",e.teamList=[],e}return Object(p["a"])(t,e),Object(d["a"])(t,[{key:"handlePathChange",value:function(e){this.defaultActive=e.split(qTouch.basePath)[1]||"";var t=this.$refs.elMenu.items[this.defaultActive];t&&this.handleSelectMenu(t.index,t.indexPath)}},{key:"created",value:function(){var e=localStorage.getItem("menus");e&&(this.menuData=JSON.parse(e),N["a"].convertMenus(this.menuData,this.hashMap)),qTouch.on("switchFullscreen",this.switchFullscreen),this.fullscreen=!!localStorage.getItem("isFullScreen"),this.fullscreen?document.body.classList.add("full-screen"):document.body.classList.remove("full-screen"),qTouch.on("changeName",this.handleChangeName),window.addEventListener("single-spa:routing-event",this.handleRouteChange),this.getTeamList(),this.getUserInfo()}},{key:"mounted",value:function(){var e=this.$refs.elMenu.items[this.defaultActive];e&&this.handleSelectMenu(e.index,e.indexPath)}},{key:"beforeDestroy",value:function(){qTouch.off("switchFullscreen",this.switchFullscreen),qTouch.off("changeName",this.handleChangeName),window.removeEventListener("single-spa:routing-event",this.handleRouteChange)}},{key:"switchFullscreen",value:function(e){e?localStorage.setItem("isFullScreen","1"):localStorage.removeItem("isFullScreen"),location.reload()}},{key:"handleChangeName",value:function(e){this.realName=e}},{key:"handleSelect",value:function(e){"_self"===e.target?1===e.pathType?qTouch.navigateToUrl(e.path):3===e.pathType?this.getDetailAddress(e.path,e.target):qTouch.navigateToUrl("/qTouch/openPath?path="+e.path):3===e.pathType?this.getDetailAddress(e.path,e.target):window.open(e.path,e.target)}},{key:"getDetailAddress",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,a){var n,o,r,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(t);case 2:n=e.sent,o=n.data,r=o.data,s=o.status,c=o.message,s?(console.log(r),"_self"===a?qTouch.navigateToUrl("/qTouch/openPath?path="+r):window.open(r,a)):this.$message.error(c);case 8:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"handleSelectMenu",value:function(e,t){var a=this,n=this.menuData;this.locationInfo=[],t.forEach((function(e){var t=n.find((function(t){return t.path===e}));t&&(a.locationInfo.push(t.name),n=t.children)}))}},{key:"handleToRoot",value:function(){qTouch.navigateToUrl(qTouch.appPathMap.root)}},{key:"handleFoldMenu",value:function(){qTouch.emit("switchFullscreen",!0)}},{key:"handleUnFoldMenu",value:function(){qTouch.emit("switchFullscreen",!1)}},{key:"getTeamList",value:function(){var e=this;this.$http.get(C.getTeamList).then((function(t){if(t.data.status){for(var a in e.teamList=t.data.data,e.teamList)if(e.teamList[a].currentFlag){e.currentTeam=e.teamList[a].tenantId;break}}else e.$message.error(t.data.message)}))}},{key:"getUserInfo",value:function(){this.$http.get(A["a"].getAccountInfo).then((function(e){e.data.status&&localStorage.setItem("realName",e.data.data.realName)}))}},{key:"changeTeam",value:function(e){var t=this;this.$confirm("确定切换？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.get(C.changeTeam,{params:{tenantId:t.currentTeam}}).then((function(e){if(e.data.status){var a=e.data.data;t.$message.success("切换成功"),localStorage.clear(),x["a"].set("accessToken",a.accessToken),localStorage.setItem("menus",JSON.stringify(a.menus)),localStorage.setItem("realName",a.realName),localStorage.setItem("userName",a.username);var n={};a.baseTypes.forEach((function(e){n[e.code]=!0})),localStorage.setItem("baseTypeCodeMap",JSON.stringify(n)),qTouch.navigateToUrl(qTouch.appPathMap.root),window.location.reload()}else t.$message.error(e.data.message)}))})).catch((function(){for(var e in t.teamList)if(t.teamList[e].currentFlag){t.currentTeam=t.teamList[e].tenantId;break}}))}},{key:"logout",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("确定退出？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.post(C.logout).then((function(e){e.data.status?(localStorage.clear(),x["a"].remove("accessToken"),qTouch.navigateToUrl(qTouch.appPathMap.login)):t.$message.error(e.data.message)}))})).catch((function(){}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"goPersonInfo",value:function(e){this.locationInfo="/personInfo"===e?["个人中心"]:["修改密码"],qTouch.navigateToUrl(qTouch.appPathMap.root+e)}},{key:"handleToHistoryPath",value:function(){if("/"===location.pathname){var e=localStorage.getItem("historyPath");e?qTouch.navigateToUrl(e):qTouch.navigateToUrl(qTouch.appPathMap.login)}}},{key:"handleRouteChange",value:function(){location.pathname.startsWith(qTouch.basePath)?localStorage.setItem("historyPath",location.pathname+location.hash):localStorage.setItem("historyPath","");var e=window.location.pathname;"/"===e?qTouch.navigateToUrl(qTouch.appPathMap.login):/\/root/.test(e)||/\/login/.test(e)||/\/error\//.test(e)||this.hashMap[e];var t=location.pathname.match(new RegExp(qTouch.basePath+"(/[^/]+)"));"/"!==location.pathname&&(!t||Object.values(qTouch.appPathMap).includes(t[1]))}}],[{key:"genMenus",value:function(e,t,a){t++,e&&e.forEach((function(e){1===t&&(e.path=a+e.path.substr(1)),2===t&&(e.path=a+e.path),I.genMenus(e.children,t,e.path)}))}}]),t}(g["e"]);m["__decorate"]([Object(g["f"])("$route.path")],L.prototype,"handlePathChange",null),L=I=m["__decorate"]([Object(g["a"])({components:{QMenu:M}})],L);var $=L,F=$,U=(a("6b19"),a("6bfb"),Object(O["a"])(F,c,i,!1,null,"3a331526",null)),B=U.exports;n["default"].use(s["a"]);var D={mode:"history",base:qTouch.basePath+qTouch.appPathMap.navBar,routes:[]},R=D,E=a("c947"),J=(a("4ca3"),a("443e")),Q=a.n(J),z=Q.a,H=z,V={install:function(e){e.component("qMenu",M)}},W=a("3b21"),G=a("3348"),K=a("d26d"),X=a("8162"),Y=a("427a"),Z=a("663b"),ee=a("3c8d"),te=a("5d37"),ae=a("ffeb"),ne=a("0848"),oe=a("4579"),re=a("56b0"),se=a("b301"),ce=a("60ab"),ie=a("7969"),ue=a("537f"),le=a("6156"),de=a("bda4"),he=a("80d3"),fe=a("1b9c");n["default"].use(E["a"]),n["default"].use(H),n["default"].use(V),n["default"].use(W["a"]),n["default"].use(G["a"]),n["default"].use(K["a"]),n["default"].use(X["a"]),n["default"].use(Y["a"]),n["default"].use(Z["a"]),n["default"].use(G["a"]),n["default"].use(ee["a"]),n["default"].use(te["a"]),n["default"].use(ae["a"]),n["default"].use(ne["a"]),n["default"].use(oe["a"]),n["default"].use(re["a"]),n["default"].use(se["a"]),n["default"].use(ce["a"]),n["default"].use(ie["a"]),n["default"].use(ue["a"]),n["default"].use(le["a"]),n["default"].use(de["a"]),n["default"].use(he["a"]),n["default"].use(fe["a"]),a.d(t,"bootstrap",(function(){return me})),a.d(t,"mount",(function(){return ge})),a.d(t,"unmount",(function(){return ve})),n["default"].config.productionTip=!1;var pe=r()({Vue:n["default"],appOptions:function(){return{router:new s["a"](R),render:function(e){return e(B)}}}}),me=pe.bootstrap,ge=pe.mount,ve=pe.unmount},"6b19":function(e,t,a){"use strict";var n=a("ecd1"),o=a.n(n);o.a},"6bfb":function(e,t,a){"use strict";var n=a("b503"),o=a.n(n);o.a},b503:function(e,t,a){},ecd1:function(e,t,a){}})}));
//# sourceMappingURL=navBar.af36a0099dc75bd99bf9.js.map