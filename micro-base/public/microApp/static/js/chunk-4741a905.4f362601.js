(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-4741a905"],{"0a45":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-left-right-layout",{staticStyle:{width:"100%",height:"100%"},attrs:{"left-title":"组织机构树","right-title":e.orgName+" 配置详情"}},[a("div",{staticClass:"left-slot",attrs:{slot:"left"},slot:"left"},[a("el-input",{staticClass:"inpW",attrs:{placeholder:"输入关键字进行过滤",maxlength:100,size:"small"},model:{value:e.treeMessage.filterText,callback:function(t){e.$set(e.treeMessage,"filterText",t)},expression:"treeMessage.filterText"}}),a("div",{staticClass:"tree-body"},[a("el-tree",{ref:"orgTree",staticClass:"filter-tree",attrs:{data:e.treeMessage.data,props:e.defaultProps,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.orgNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return a("div",{staticClass:"tree-node"},[a("span",{staticStyle:{display:"inline-block","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","word-break":"keep-all"},style:{width:200-18*(s.treeLevel-1)+"px"}},[e._v(e._s(s.label))])])}}])})],1)],1),e.hasMap?e._t("default",[a("div",{staticClass:"tool-bar-button"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.penalName="map"}}},[e._v("地图")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"map"===e.penalName,expression:"penalName === 'map'"}],staticClass:"triangle-top"})],1),a("div",{staticClass:"tool-bar-button"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.penalName="toolBar"}}},[e._v("工具栏")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"toolBar"===e.penalName,expression:"penalName === 'toolBar'"}],staticClass:"triangle-top"})],1),a("div",{staticClass:"tool-bar-button"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.penalName="charts"}}},[e._v("图表")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"charts"===e.penalName,expression:"penalName === 'charts'"}],staticClass:"triangle-top"})],1)],{slot:"tools"}):e._e(),a("div",{staticClass:"right-slot",attrs:{slot:"right"},slot:"right"},[[a("div",{ref:"orgMap",staticClass:"org-map",attrs:{id:"org-map"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.hasMap,expression:"!hasMap"}],staticClass:"map-empty"},[a("div",{staticClass:"empty-message"},[e._v("当前无地图")]),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.openMapConfigPenal}},[e._v("添加地图")])],1)],a("transition",{attrs:{name:"penal-body"}},[e.showControlPenal?a("div",{staticClass:"control-penal"},[a("transition",{attrs:{name:"penal"}},[a(e.witchComponent,{tag:"component",attrs:{title:e.controls[e.penalName],"org-id":e.orgId,"map-config":e.mapConfig,map:e.map,mode:e.editMode},on:{close:e.closeControlPenal,mapConfigChange:e.changeMapStyle}})],1)],1):e._e()])],2)],2)},n=[],r=(a("28a5"),a("96cf"),a("3b8d")),i=(a("7f7f"),a("d225")),o=a("b0b4"),l=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("60a3"),m=a("dc7d"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-penal-body"},[a("div",{staticClass:"penal-header"},[a("span",[e._v(e._s(e.title))]),a("el-button",{staticStyle:{padding:"0","line-height":"20px"},attrs:{type:"text"},on:{click:function(t){return e.$emit("close")}}},[a("el-icon",{staticClass:"el-icon-close"})],1)],1),a("el-form",{ref:"mapForm",attrs:{model:e.configs,"label-width":"100px",size:"small",rules:e.formRules}},[a("el-form-item",{attrs:{label:"地图源:",prop:"mapRegion"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:!1,size:"small"},model:{value:e.configs.mapRegion,callback:function(t){e.$set(e.configs,"mapRegion",t)},expression:"configs.mapRegion"}},e._l(e.sources,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"地图风格:",prop:"style"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:!1,size:"small"},on:{change:e.handleChange},model:{value:e.configs.style,callback:function(t){e.$set(e.configs,"style",t)},expression:"configs.style"}},e._l(e.mapPresetStyles,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"缩放层级:",prop:"mapScale"}},[a("el-slider",{attrs:{"show-input":"",min:3,max:18,"input-size":"mini"},on:{change:e.handleChange},model:{value:e.configs.mapScale,callback:function(t){e.$set(e.configs,"mapScale",t)},expression:"configs.mapScale"}})],1),a("el-form-item",{attrs:{label:"地图中心:",prop:"mapCenter"}},[a("el-input",{on:{change:e.handleChange},model:{value:e.configs.mapCenter,callback:function(t){e.$set(e.configs,"mapCenter",t)},expression:"configs.mapCenter"}},[a("el-button",{attrs:{slot:"append"},on:{click:function(t){return e.chooseCenterOnMap(e.mapClick)}},slot:"append"},[e._v(e._s(e.mapClick?"结束选点":"地图选点"))])],1)],1)],1),a("div",{staticClass:"penal-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$emit("close")}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveMapConfig}},[e._v("确定")])],1)],1)},g=[],f=(a("8e6e"),a("ac6a"),a("456d"),a("bd86"));function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){Object(f["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=window.AMap,k=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.sources=[{label:"高德地图",value:"amap"}],e.configs=e.mapConfig,e.mapClick=!1,e.clickListener=null,e.formRules={mapRegion:{required:!0,message:"请输入名称",trigger:"change"},style:{required:!0,message:"样式不能为空",trigger:"blur"},mapCenter:{required:!0,message:"中心点不能为空",trigger:"blur"}},e.mapPresetStyles=[{label:"标准",value:"normal"},{label:"幻影黑",value:"dark"},{label:"月光银",value:"light"},{label:"远山黛",value:"whitesmoke"},{label:"草色青",value:"fresh"},{label:"雅士灰",value:"grey"},{label:"涂鸦",value:"graffiti"},{label:"马卡龙",value:"macaron"},{label:"靛青蓝",value:"blue"},{label:"极夜蓝",value:"darkblue"},{label:"酱籽",value:"wine"},{label:"QT-dark",value:"c557b410d7210c8530b0269adba25f5c"}],e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"handleChangeOrg",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleChange",value:function(){this.$emit("mapConfigChange",this.configs)}},{key:"chooseCenterOnMap",value:function(e){var t=this;e?y.event.removeListener(this.clickListener):this.clickListener=y.event.addListener(this.map,"dblclick",(function(e){t.configs.mapCenter=e.lnglat.getLng()+","+e.lnglat.getLat(),t.$message.success("您当前选择了[".concat(t.configs.mapCenter,"]作为地图中心点")),t.handleChange()})),this.mapClick=!this.mapClick}},{key:"saveMapConfig",value:function(){var e=this;this.$refs["mapForm"].validate((function(t){t&&e.$http.post(m["a"].settings.setMapConfig,v({},e.configs,{orgId:e.orgId,mapKey:"fbc043611829448a8d799c0a5fef544a"})).then((function(t){t.data.status?e.$message.success("保存成功！"):e.$message.error(t.data.message)}))}))}}]),t}(d["e"]);p["__decorate"]([Object(d["d"])({type:String})],k.prototype,"title",void 0),p["__decorate"]([Object(d["d"])({type:String})],k.prototype,"orgId",void 0),p["__decorate"]([Object(d["d"])({type:Object})],k.prototype,"map",void 0),p["__decorate"]([Object(d["d"])({type:Object})],k.prototype,"mapConfig",void 0),p["__decorate"]([Object(d["f"])("orgId",{immediate:!0})],k.prototype,"handleChangeOrg",null),k=p["__decorate"]([Object(d["a"])({})],k);var C=k,I=C,w=(a("9b2f"),a("2877")),O=Object(w["a"])(I,h,g,!1,null,"665cc8e6",null),x=O.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-penal-body"},[a("div",{staticClass:"penal-header"},[a("span",[e._v(e._s(e.title))]),a("el-button",{staticStyle:{padding:"0","line-height":"20px"},attrs:{type:"text"},on:{click:function(t){return e.$emit("close")}}},[a("el-icon",{staticClass:"el-icon-close"})],1)],1),a("transition",{attrs:{name:"blocked-out"}},[e.componentStatus?a("div",{key:"list",staticClass:"tool-config-body"},[a("div",{staticClass:"user-define-tools"},[a("div",{staticClass:"user-define-title"},[a("span",[e._v("自定义工具栏")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addNewChart}},[e._v("新建工具栏")])],1),a("div",{staticClass:"user-define-list"},e._l(e.userToolsList,(function(t){return a("div",{key:t.sortNum,staticClass:"list-item"},[a("div",{staticClass:"item-name"},[e._v(e._s(t.name))]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.moveItems(t.id,0)}}},[a("i",{staticClass:"font_family icon-shangyi"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.moveItems(t.id,1)}}},[a("i",{staticClass:"font_family icon-xiayi"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.getToolItemDetail(t.id)}}},[a("i",{staticClass:"el-icon-edit"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.deleteToolItem(t.id)}}},[a("i",{staticClass:"el-icon-delete"})])],1)})),0)]),a("div",{staticClass:"system-tools"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"systemData",label:"系统数据"}},[a("el-checkbox-group",{model:{value:e.checkedSystemData,callback:function(t){e.checkedSystemData=t},expression:"checkedSystemData"}},[a("el-checkbox",{attrs:{label:"systemPerson"}},[e._v("人员")]),a("el-checkbox",{attrs:{label:"systemCar"}},[e._v("车辆")]),a("el-checkbox",{attrs:{label:"systemDevice"}},[e._v("设备")]),a("el-checkbox",{attrs:{label:"systemBuilding"}},[e._v("建筑")])],1)],1),a("el-tab-pane",{attrs:{name:"systemTools",label:"系统工具"}},[a("el-checkbox-group",{model:{value:e.checkedSystemTools,callback:function(t){e.checkedSystemTools=t},expression:"checkedSystemTools"}},[a("el-checkbox",{attrs:{label:"range"}},[e._v("范围")]),a("el-checkbox",{attrs:{label:"distance"}},[e._v("测距")]),a("el-checkbox",{attrs:{label:"viewMode"}},[e._v("二三维切换")]),a("el-checkbox",{attrs:{label:"satellite"}},[e._v("卫星")]),a("el-checkbox",{attrs:{label:"road"}},[e._v("路况")])],1)],1)],1)],1),a("div",{staticClass:"penal-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$emit("close")}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.setSystemTools}},[e._v("确定")])],1)]):a("div",{key:"add",staticClass:"tool-config-body"},[a("el-form",{ref:"toolForm",attrs:{model:e.toolItem,"label-width":"100px",size:"small",rules:e.formRules}},[a("el-form-item",{attrs:{label:"图层名称：",prop:"name"}},[a("el-input",{model:{value:e.toolItem.name,callback:function(t){e.$set(e.toolItem,"name",t)},expression:"toolItem.name"}})],1),a("el-form-item",{attrs:{label:"图层图标：",prop:"icons"}},[a("q-upload",{attrs:{prev:!1,"limit-num":1,accept:"image/bmp,image/png,image/jpeg",size:2},model:{value:e.toolItem.icons,callback:function(t){e.$set(e.toolItem,"icons",t)},expression:"toolItem.icons"}})],1),a("el-form-item",{attrs:{label:"默认显示：",prop:"isShow"}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.toolItem.isShow,callback:function(t){e.$set(e.toolItem,"isShow",t)},expression:"toolItem.isShow"}})],1),a("el-form-item",{attrs:{label:"图层数据：",prop:"typeId"}},[a("el-select",{staticStyle:{width:"100%"},on:{change:e.getSelectedTypeTree},model:{value:e.toolItem.typeId,callback:function(t){e.$set(e.toolItem,"typeId",t)},expression:"toolItem.typeId"}},[a("el-option",{attrs:{value:"person",label:"人员"}}),a("el-option",{attrs:{value:"device",label:"设备"}}),a("el-option",{attrs:{value:"car",label:"车辆"}}),a("el-option",{attrs:{value:"building",label:"建筑"}})],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dataLoading,expression:"dataLoading"}],staticClass:"tree-body"},[a("el-tree",{ref:"typeTree",attrs:{"node-key":"id",data:e.typeTreeData,props:e.typeTreeProps,"show-checkbox":"","check-strictly":""},on:{"check-change":e.checkedChange}})],1)],1),a("div",{staticClass:"penal-footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.backToList}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveToolsItem}},[e._v("确定")])],1)],1)])],1)},T=[];function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){Object(f["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.componentStatus=!0,e.activeName="systemData",e.checkedSystemData=[],e.checkedSystemTools=[],e.userToolsList=[],e.toolItem={isShow:!1,icons:[],typeDataIds:[],icon:""},e.typeTreeData=[],e.typeTreeProps={children:"children",label:"name"},e.dataLoading=!1,e.editMode="add",e.formRules={name:{required:!0,message:"工具名称不能为空",trigger:"blur"},icons:{required:!0,message:"图标不能为空",trigger:"change"},typeId:{required:!0,message:"类型不能为空",trigger:"blur"}},e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"addNewChart",value:function(){this.editMode="add",this.componentStatus=!1}},{key:"getUserToolsList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("".concat(m["a"].settings.getUserToolsList,"?orgId=").concat(this.orgId));case 3:t=e.sent,a=t.data,s=a.data,n=a.status,r=a.message,n?this.userToolsList=s:this.$message.error(r),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"moveItems",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){var s,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get(m["a"].settings.moveUserToolsItems,{params:{flag:a,toolbarId:t,orgId:this.orgId}});case 3:s=e.sent,n=s.data,n.data,r=n.status,i=n.message,r?(this.$message.success("移动成功"),this.getUserToolsList()):this.$message.error(i),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"getSelectedTypeTree",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,s,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.dataLoading=!0,e.prev=1,e.next=4,this.$http.get("".concat(m["a"].settings.findTypeTree,"/").concat(t));case 4:a=e.sent,s=a.data,n=s.data,r=s.status,i=s.message,r?this.typeTreeData=n:this.$message.error(i),e.next=15;break;case 12:return e.prev=12,e.t0=e["catch"](1),e.abrupt("return");case 15:return e.prev=15,this.dataLoading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getToolItemDetail",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,s,n,r,i,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.editMode="edit",this.componentStatus=!1,e.prev=2,e.next=5,this.$http.get("".concat(m["a"].settings.getUserToolsItem,"?toolbarId=").concat(t,"&orgId=").concat(this.orgId));case 5:a=e.sent,s=a.data,n=s.data,r=s.status,i=s.message,r?(this.toolItem=n,this.toolItem.toolbarId=t,this.toolItem.icons=[{name:"icon",url:n.icon}],this.componentStatus=!1,this.getSelectedTypeTree(n.typeId).then((function(){o.$nextTick((function(){o.$refs["typeTree"].setCheckedKeys(o.toolItem.typeDataIds)}))}))):this.$message.error(i),e.next=16;break;case 13:return e.prev=13,e.t0=e["catch"](2),e.abrupt("return");case 16:case"end":return e.stop()}}),e,this,[[2,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"checkedChange",value:function(){this.toolItem.typeDataIds=this.$refs["typeTree"].getCheckedNodes().map((function(e){return e.id}))}},{key:"saveToolsItem",value:function(){var e=this,t="add"===this.editMode?m["a"].settings.addUserToolsItem:m["a"].settings.updateUserToolsItem;this.$refs["toolForm"].validate((function(a){a&&(e.toolItem.typeDataIds&&e.toolItem.typeDataIds.length?e.$http.post(t,S({},e.toolItem,{icon:e.toolItem.icons[0].url,orgId:e.orgId})).then((function(t){t.data.status?(e.$message.success("保存成功！"),e.getUserToolsList(),e.backToList()):e.$message.error(t.data.message)})):e.$message.warning("请选择至少一项数据类型"))}))}},{key:"deleteToolItem",value:function(e){var t=this;this.$http.get("".concat(m["a"].settings.deleteUserToolsItem,"?toolbarId=").concat(e,"&orgId=").concat(this.orgId)).then((function(e){e.data.status?(t.$message.success("删除成功！"),t.getUserToolsList()):t.$message.error(e.data.message)}))}},{key:"getSystemTools",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("".concat(m["a"].settings.getSystemTools,"?orgId=").concat(this.orgId));case 3:t=e.sent,a=t.data,s=a.data,n=a.status,r=a.message,n?(this.checkedSystemData=JSON.parse(s).checkedSystemData,this.checkedSystemTools=JSON.parse(s).checkedSystemTools):this.$message.error(r),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setSystemTools",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.post(m["a"].settings.setSystemTools,{orgId:this.orgId,toolbarJson:JSON.stringify({checkedSystemData:this.checkedSystemData,checkedSystemTools:this.checkedSystemTools})});case 3:t=e.sent,a=t.data,a.data,s=a.status,n=a.message,s?this.$message.success("保存成功！"):this.$message.error(n),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"backToList",value:function(){this.componentStatus=!0,this.toolItem={isShow:!1,icons:[],typeDataIds:[],icon:""}}},{key:"created",value:function(){this.getUserToolsList(),this.getSystemTools()}}]),t}(d["e"]);p["__decorate"]([Object(d["d"])({type:String})],$.prototype,"title",void 0),p["__decorate"]([Object(d["d"])({type:String})],$.prototype,"orgId",void 0),$=p["__decorate"]([Object(d["a"])({})],$);var M=$,P=M,D=(a("9dec"),Object(w["a"])(P,_,T,!1,null,"33bc1cd2",null)),z=D.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"control-penal-body"},[a("div",{staticClass:"penal-header"},[a("span",[e._v(e._s(e.title))]),a("el-button",{staticStyle:{padding:"0","line-height":"20px"},attrs:{type:"text"},on:{click:function(t){return e.$emit("close")}}},[a("el-icon",{staticClass:"el-icon-close"})],1)],1),a("transition",{attrs:{name:"blocked-out"}},[e.componentStatus?a("div",{key:"list",staticClass:"tool-config-body"},[a("div",{staticClass:"user-define-tools"},[a("div",{staticClass:"user-define-title"},[a("span",[e._v("左侧图表")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addNewChart}},[e._v("新建图表")])],1),a("div",{staticClass:"user-define-list"},e._l(e.leftChartsList,(function(t){return a("div",{key:t.charId,staticClass:"list-item"},[a("div",{staticClass:"item-name"},[e._v(e._s(t.name))]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.moveItems(t.charId,0)}}},[a("i",{staticClass:"font_family icon-shangyi"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.moveItems(t.charId,1)}}},[a("i",{staticClass:"font_family icon-xiayi"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.getChartItemDetail(t.charId)}}},[a("i",{staticClass:"el-icon-edit"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.deleteChartItem(t.charId)}}},[a("i",{staticClass:"el-icon-delete"})])],1)})),0)]),a("div",{staticClass:"user-define-tools"},[a("div",{staticClass:"user-define-title"},[a("span",[e._v("右侧图表")])]),a("div",{staticClass:"user-define-list"},e._l(e.rightChartsList,(function(t){return a("div",{key:t.charId,staticClass:"list-item"},[a("div",{staticClass:"item-name"},[e._v(e._s(t.name))]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.moveItems(t.charId,0)}}},[a("i",{staticClass:"font_family icon-shangyi"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.moveItems(t.charId,1)}}},[a("i",{staticClass:"font_family icon-xiayi"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.getChartItemDetail(t.charId)}}},[a("i",{staticClass:"el-icon-edit"})]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.deleteChartItem(t.charId)}}},[a("i",{staticClass:"el-icon-delete"})])],1)})),0)]),a("div",{staticClass:"penal-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$emit("close")}}},[e._v("取消")])],1)]):a("div",{key:"add",staticClass:"tool-config-body"},[a("el-form",{ref:"chartForm",attrs:{model:e.chartItem,"label-width":"100px",size:"small",rules:e.formRules}},[a("el-form-item",{attrs:{label:"图标名称：",prop:"name"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.chartItem.name,callback:function(t){e.$set(e.chartItem,"name",t)},expression:"chartItem.name"}})],1),a("el-form-item",{attrs:{label:"图表位置：",prop:"position"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:!1,size:"small"},model:{value:e.chartItem.position,callback:function(t){e.$set(e.chartItem,"position",t)},expression:"chartItem.position"}},[a("el-option",{attrs:{label:"左侧",value:0}}),a("el-option",{attrs:{label:"右侧",value:1}})],1)],1),a("el-form-item",{attrs:{label:"图表尺寸："}},[a("div",{staticClass:"size-content"},[a("span",{staticClass:"size-label"},[e._v("w：")]),a("el-input-number",{model:{value:e.chartItem.width,callback:function(t){e.$set(e.chartItem,"width",t)},expression:"chartItem.width"}}),a("span",{staticClass:"size-label",staticStyle:{"margin-left":"16px"}},[e._v("h：")]),a("el-input-number",{model:{value:e.chartItem.height,callback:function(t){e.$set(e.chartItem,"height",t)},expression:"chartItem.height"}})],1)]),a("el-form-item",{attrs:{label:"图标链接：",prop:"url"}},[a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.chartItem.url,callback:function(t){e.$set(e.chartItem,"url",t)},expression:"chartItem.url"}})],1)],1),a("div",{staticClass:"penal-footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.backToList}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.checkFormRules}},[e._v("确定")])],1)],1)])],1)},N=[];function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){Object(f["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var U=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.componentStatus=!0,e.chartItem={},e.leftChartsList=[],e.rightChartsList=[],e.editMode="add",e.formRules={name:{required:!0,message:"图表名称不能为空",trigger:"blur"},position:{required:!0,message:"位置不能为空",trigger:"change"},url:{required:!0,message:"链接地址不能为空",trigger:"blur"}},e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){this.getChartsList()}},{key:"addNewChart",value:function(){this.editMode="add",this.componentStatus=!1}},{key:"getChartsList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("".concat(m["a"].settings.getChartsList,"?orgId=").concat(this.orgId));case 3:t=e.sent,a=t.data,s=a.data,n=a.status,r=a.message,n?(console.log(s),this.leftChartsList=s.filter((function(e){return 0===e.position})),this.rightChartsList=s.filter((function(e){return 1===e.position}))):this.$message.error(r),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"moveItems",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){var s,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get(m["a"].settings.moveChartsItems,{params:{flag:a,chartId:t,orgId:this.orgId}});case 3:s=e.sent,n=s.data,n.data,r=n.status,i=n.message,r?(this.$message.success("移动成功"),this.getChartsList()):this.$message.error(i),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"getChartItemDetail",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,s,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.editMode="edit",e.prev=1,e.next=4,this.$http.get("".concat(m["a"].settings.getChartsItem,"?chartId=").concat(t,"&orgId=").concat(this.orgId));case 4:a=e.sent,s=a.data,n=s.data,r=s.status,i=s.message,r?(this.chartItem=n,this.componentStatus=!1):this.$message.error(i),e.next=15;break;case 12:return e.prev=12,e.t0=e["catch"](1),e.abrupt("return");case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteChartItem",value:function(e){var t=this;this.$http.get("".concat(m["a"].settings.deleteChartsItem,"?chartId=").concat(e,"&orgId=").concat(this.orgId)).then((function(e){e.data.status?(t.$message.success("删除成功！"),t.getChartsList()):t.$message.error(e.data.message)}))}},{key:"checkFormRules",value:function(){var e=this;this.$refs["chartForm"].validate((function(t){t&&(e.chartItem.width&&e.chartItem.height?e.saveCharItem():e.$message.warning("请设置图表尺寸"))}))}},{key:"saveCharItem",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.post("add"===this.editMode?m["a"].settings.addChartsItem:m["a"].settings.updateChartsItem,B({},this.chartItem,{orgId:this.orgId}));case 3:t=e.sent,a=t.data,a.data,s=a.status,n=a.message,s?(this.$message.success("保存成功！"),this.componentStatus=!0,this.getChartsList(),this.chartItem={}):this.$message.error(n),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"backToList",value:function(){this.componentStatus=!0,this.chartItem={}}}]),t}(d["e"]);p["__decorate"]([Object(d["d"])({type:String})],U.prototype,"title",void 0),p["__decorate"]([Object(d["d"])({type:String})],U.prototype,"orgId",void 0),U=p["__decorate"]([Object(d["a"])({})],U);var F=U,q=F,E=(a("caee"),Object(w["a"])(q,L,N,!1,null,"6efa9afa",null)),J=E.exports,A=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.orgName="",e.treeMessage={filterText:"",data:[]},e.defaultProps={value:"id",label:"name",children:"children"},e.hasMap=!1,e.showControlPenal=!1,e.penalName="",e.controls={map:"地图配置",toolBar:"工具栏配置",charts:"图表配置"},e.witchComponent="MapControlPenal",e.editMode="add",e.mapConfig={mapRegion:"amap"},e.userDefinedTools=[],e.chartsList=[],e.orgId="",e.oldKey="",e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"filterNode",value:function(e,t){return!e||-1!==t[this.defaultProps.label].indexOf(e)}},{key:"setFilterText",value:function(e){this.$refs.orgTree.filter(e)}},{key:"switchComponent",value:function(){if(this.penalName)switch(this.showControlPenal=!0,this.penalName){case"map":this.witchComponent="MapControlPenal";break;case"toolBar":this.witchComponent="ToolsControlPenal";break;case"charts":this.witchComponent="ChartsControlPenal";break;default:this.witchComponent="MapControlPenal"}}},{key:"getTreeData",value:function(){var e=this;this.$http.get(m["a"].organization.getOrgTreeData).then((function(t){t.data.status?e.treeMessage.data=t.data.data:e.$message.error(t.data.message)}))}},{key:"orgNodeClick",value:function(e){this.orgName=e.name,this.orgId=e.id,this.showControlPenal=!1,this.penalName="",this.getMapConfig()}},{key:"openMapConfigPenal",value:function(){this.hasMap=!0}},{key:"hideMapConfigPenal",value:function(){this.hasMap=!1,this.penalName="",this.showControlPenal=!1,this.mapConfig={mapRegion:"amap",mapScale:10,style:"normal"},this.changeMapStyle(this.mapConfig)}},{key:"getMapConfig",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get(m["a"].settings.getMapConfig,{params:{orgId:this.orgId}});case 3:t=e.sent,a=t.data,s=a.data,n=a.status,r=a.message,n?s?(this.mapConfig=s,this.changeMapStyle(this.mapConfig),this.openMapConfigPenal()):this.hideMapConfigPenal():this.$message.error(r),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"initMap",value:function(){var e=this;this.$nextTick((function(){e.map=new window.AMap.Map("org-map",{center:[106.5,29.5],zoom:10,doubleClickZoom:!1}).on("zoomchange",(function(t){e.mapConfig.mapScale=e.map.getZoom()}))}))}},{key:"changeMapStyle",value:function(e){e.style&&this.map.setMapStyle("amap://styles/".concat(e.style)),e.mapCenter&&(this.mapConfig.mapCenter=e.mapCenter,this.map.setCenter(e.mapCenter.split(","))),e.mapScale&&this.map.setZoom(e.mapScale)}},{key:"closeControlPenal",value:function(){this.penalName="",this.showControlPenal=!this.showControlPenal}},{key:"mounted",value:function(){this.getTreeData(),this.initMap()}},{key:"beforeDestroy",value:function(){this.map.destroy(),this.map=null,console.log(this.map)}}]),t}(d["e"]);p["__decorate"]([Object(d["f"])("treeMessage.filterText")],A.prototype,"setFilterText",null),p["__decorate"]([Object(d["f"])("penalName",{immediate:!0})],A.prototype,"switchComponent",null),A=p["__decorate"]([Object(d["a"])({components:{MapControlPenal:x,ToolsControlPenal:z,ChartsControlPenal:J}})],A);var K=A,Z=K,V=(a("9758"),Object(w["a"])(Z,s,n,!1,null,"4bd5a6fc",null));t["default"]=V.exports},"0d7d":function(e,t,a){},"456d":function(e,t,a){var s=a("4bf8"),n=a("0d58");a("5eda")("keys",(function(){return function(e){return n(s(e))}}))},"5eda":function(e,t,a){var s=a("5ca1"),n=a("8378"),r=a("79e5");e.exports=function(e,t){var a=(n.Object||{})[e]||Object[e],i={};i[e]=t(a),s(s.S+s.F*r((function(){a(1)})),"Object",i)}},"8e6e":function(e,t,a){var s=a("5ca1"),n=a("990b"),r=a("6821"),i=a("11e9"),o=a("f1ae");s(s.S,"Object",{getOwnPropertyDescriptors:function(e){var t,a,s=r(e),l=i.f,c=n(s),u={},p=0;while(c.length>p)a=l(s,t=c[p++]),void 0!==a&&o(u,t,a);return u}})},9354:function(e,t,a){},9758:function(e,t,a){"use strict";var s=a("0d7d"),n=a.n(s);n.a},"990b":function(e,t,a){var s=a("9093"),n=a("2621"),r=a("cb7c"),i=a("7726").Reflect;e.exports=i&&i.ownKeys||function(e){var t=s.f(r(e)),a=n.f;return a?t.concat(a(e)):t}},"9b2f":function(e,t,a){"use strict";var s=a("9354"),n=a.n(s);n.a},"9bc5":function(e,t,a){},"9dec":function(e,t,a){"use strict";var s=a("9bc5"),n=a.n(s);n.a},b58f:function(e,t,a){},bd86:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a("85f2"),n=a.n(s);function r(e,t,a){return t in e?n()(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},caee:function(e,t,a){"use strict";var s=a("b58f"),n=a.n(s);n.a},dc7d:function(e,t,a){"use strict";var s="/admin/map/custom",n={mapArrangement:{getBaseMapList:"/admin/basemap/pagination",addBaseMap:"/admin/basemap/add",updateBaseMap:"/admin/basemap/update",deleteBaseMap:"/admin/basemap/delete",addBaseMapOrganization:"/admin/basemap/addBaseMapOrganization/",listBaseMapOrgByBaseMapId:"/admin/basemap/listBaseMapOrgByBaseMapId/",getByDetailId:"/admin/basemap/getByDetailId/"},organization:{getTreeData:"/admin/typeDetail/findTypeTree/organization",getOrgTreeData:"/admin/organization/orgTree",getRegions:"/admin/region/listTree"},grid:{getGridsByOrganizationId:"/admin/grid/paging/",gridAdd:"/admin/grid/add",gridUpdate:"/admin/grid/update"},fence:{getElectricFenceByOrganizationId:"/admin/electronic/fence/paging",fenceAdd:"/admin/electronic/fence/add",fenceUpdate:"/admin/electronic/fence/update",bindPerson:"/admin/electronic/fence/bindPerson/",bindCar:"/admin/electronic/fence/bindCar/"},person:{getPaging:"/admin/person/pagingPerson"},car:{getPaging:"/admin/car/pagingCar"},settings:{findTypeTree:"/admin/typeDetail/findTypeTree",getMapConfig:s+"/style/get",setMapConfig:s+"/style/set",getUserToolsList:s+"/toolbar/list",getUserToolsItem:s+"/toolbar/detail",addUserToolsItem:s+"/toolbar/add",updateUserToolsItem:s+"/toolbar/detail/update",deleteUserToolsItem:s+"/toolbar/delete",moveUserToolsItems:s+"/toolbar/move",getSystemTools:"/admin/map/system/toolbar/get",setSystemTools:"/admin/map/system/toolbar/set",getChartsList:s+"/chart/list",getChartsItem:s+"/chart/detail",addChartsItem:s+"/chart/add",updateChartsItem:s+"/chart/detail/update",deleteChartsItem:s+"/chart/delete",moveChartsItems:s+"/chart/move"},location:{getLocationManageList:"/admin/location/list",saveBaseInfo:"/admin/location/add",updateBaseInfo:"/admin/location/update",getBaseInfo:"/admin/location/get/",deleteBaseInfo:"/admin/location/delete/"},locationConfig:{add:"/admin/location/info/add",update:"/admin/location/info/update",get:"/admin/location/info/preViewInfo",delete:"/admin/location/info/delete/",preview:"/admin/location/info/preViewInfo"},getBaseTypeTree:"/admin/general/base/getObjectBaseTypeTree"};t["a"]=n},f1ae:function(e,t,a){"use strict";var s=a("86cc"),n=a("4630");e.exports=function(e,t,a){t in e?s.f(e,t,n(0,a)):e[t]=a}}}]);
//# sourceMappingURL=chunk-4741a905.4f362601.js.map