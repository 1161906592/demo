(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-e2d3f516"],{3251:function(e,t,s){"use strict";var r={getUserTasks:"/admin/processInstance/getUserTasks",getProcessParameter:"/admin/processInstance/getProcessParameter",handleTask:"/admin/processInstance/handleTask",getProcessImg:"/admin/processInstance/getProcessImg",getProcessDetailInfo:"/admin/processhistory/getHisProcComment/",getApplyFormValue:"/admin/processhistory/getSumbitValue/",getOngoingProcess:"/admin/processhistory/getMyUnFinishedProcess",getFinishedProcess:"/admin/processhistory/getMyFinishedProcess",getEventType:"/api/eventType/getEventType",getAllProcessType:"/admin/processType/procdeftype/findAll",processAssignState:"/admin/processDesigner/public/process/processAssignState",getAllProcessList:"/admin/processDesigner/public/visible/getAllProcessByUserVisible",getFormDefine:"/admin/formdesigner/getFormDefine",getAllUserVisible:"/admin/processDesigner/public/visible/getAllUser",getAssignTaskList:"/admin/processDesigner/public/process/getAssignTaskList",getAllOrg:"/admin/processDesigner/public/visible/getAllOrg",getAllRole:"/admin/processDesigner/public/visible/getAllRole",getAllUser:"/admin/processDesigner/public/visible/getAllUser",getFormList:"/admin/formdesigner/getFormList",saveSubmitForm:"/admin/processInstance/saveSubmitForm",getProcessInstance:"/admin/processInstance/getProcessInstance",getAllClosedProcess:"/admin/processhistory/getCompleteProcess",getRuntimeTaskAssignedList:"/admin/processInstance/getRuntimeTaskAssignedList",updateAssignedGroup:"/admin/processInstance/updateAssignedGroup"};t["a"]=r},5110:function(e,t,s){},6421:function(e,t,s){"use strict";var r=s("ab39"),a=s.n(r);a.a},6442:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[e.toDoMainPage?s("div",{staticStyle:{width:"auto",height:"auto"}},[s("div",{staticClass:"search-box"},[s("el-input",{staticStyle:{width:"240px"},attrs:{size:"small",placeholder:"流程关键字查询"},model:{value:e.processName,callback:function(t){e.processName=t},expression:"processName"}}),s("q-search-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:e.searchWithTab}},[e._v("查询")])],1),s("div",{staticClass:"content-box"},[s("el-tabs",{attrs:{type:"card"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[s("el-tab-pane",{attrs:{label:"进行中（"+e.handingTotal+"）",name:"handing"}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.handingLoading,expression:"handingLoading"}],ref:"needDealTable",staticStyle:{"margin-top":"20px","min-height":"calc(100vh - 355px)"},attrs:{data:e.handingTableData}},[s("el-table-column",{attrs:{align:"center",prop:"id",label:"序号",type:"index",width:"100",index:e.indexCustomHanding}}),s("el-table-column",{attrs:{prop:"processName",label:"流程名称","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{prop:"startTime",label:"发起时间",formatter:function(t){return e.$moment(t.startTime).format("YYYY-MM-DD HH:mm:ss")},"show-overflow-tooltip":""}}),s("el-table-column",{attrs:{prop:"assignName",label:"当前节点","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{label:"操作",width:"350",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{icon:"el-icon-edit-outline",size:"mini",type:"text",title:"查看详情"},on:{click:function(s){return e.getProcessDefine(t.row)}}},[e._v("\n                  查看详情\n                ")]),s("el-button",{attrs:{icon:"el-icon-view",size:"mini",type:"text",title:"查看当前节点"},on:{click:function(s){return e.getCurrentNode(t.row.processInstanceId)}}},[e._v("\n                  节点信息\n                ")]),s("el-button",{attrs:{icon:"el-icon-view",size:"mini",type:"text",title:"修改指派"},on:{click:function(s){return e.editTaskAssigned(t.row.processInstanceId)}}},[e._v("\n                  修改指派\n                ")])]}}],null,!1,554539345)})],1),s("q-pagination",{attrs:{"current-page":e.unfinishedQueryCriteria.current,"page-size":e.unfinishedQueryCriteria.size,layout:"total, prev, pager, next, jumper",total:e.handingTotal},on:{"current-change":e.getOngoingProcess,"update:currentPage":function(t){return e.$set(e.unfinishedQueryCriteria,"current",t)},"update:current-page":function(t){return e.$set(e.unfinishedQueryCriteria,"current",t)}}})],1),s("el-tab-pane",{attrs:{label:"已完成（"+e.finishedTotal+"）",name:"finished"}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.finishedLoading,expression:"finishedLoading"}],ref:"finishedTable",staticStyle:{"margin-top":"20px","min-height":"calc(100vh - 355px)"},attrs:{data:e.finishedTableData}},[s("el-table-column",{attrs:{align:"center",prop:"id",label:"序号",type:"index",width:"100",index:e.indexCustomFinished}}),s("el-table-column",{attrs:{prop:"processName",label:"流程名称","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{prop:"startTime",label:"发起时间",formatter:function(t){return e.$moment(t.startTime).format("YYYY-MM-DD HH:mm:ss")},"show-overflow-tooltip":""}}),s("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{icon:"el-icon-view",size:"mini",type:"text",title:"查看详情"},on:{click:function(s){return e.getProcessDefine(t.row)}}},[e._v("\n                  查看详情\n                ")])]}}],null,!1,111761149)})],1),s("q-pagination",{attrs:{"current-page":e.finishedQueryCriteria.current,"page-size":e.finishedQueryCriteria.size,total:e.finishedTotal},on:{"current-change":e.getFinishedProcess,"update:currentPage":function(t){return e.$set(e.finishedQueryCriteria,"current",t)},"update:current-page":function(t){return e.$set(e.finishedQueryCriteria,"current",t)}}})],1)],1)],1),s("el-dialog",{staticStyle:{overflow:"auto"},attrs:{title:"当前节点",width:"50%","show-close":"",visible:e.currentNodeDialog,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.currentNodeDialog=t}}},[e.currentNodeDialog?s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imgLoading,expression:"imgLoading"}],staticClass:"current-node-img"},[s("img",{ref:"processImg",attrs:{"process-src":e.currentNodeImg,alt:""}})]):e._e()]),s("el-dialog",{staticStyle:{overflow:"auto"},attrs:{title:"更改指派信息",width:"50%","show-close":"",visible:e.editTaskAssignedDialog,"destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editTaskAssignedDialog=t}}},[s("div",{staticClass:"tip-bar"},[s("i",{staticClass:"el-icon-info",staticStyle:{color:"rgba(255, 38, 53, 0.8)"}}),e._v("每个任务节点必须指派！")]),s("el-table",{staticClass:"must-input",attrs:{data:e.taskAssignedList,size:"mini",stripe:""}},[s("el-table-column",{attrs:{align:"center",property:"taskName",label:"任务名"}}),s("el-table-column",{attrs:{align:"center",label:"指派人"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-select",{attrs:{size:"mini",filterable:"",clearable:"","reserve-keyword":"",multiple:"",placeholder:"请输入姓名"},model:{value:t.row.userIds,callback:function(s){e.$set(t.row,"userIds",s)},expression:"scope.row.userIds"}},e._l(e.invisibleUserList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}],null,!1,2561591741)}),s("el-table-column",{attrs:{align:"center",label:"指派组织"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-select",{attrs:{size:"mini","reserve-keyword":"",clearable:"",filterable:"",multiple:"",placeholder:"请输入组织名"},on:{change:function(t){return e.$forceUpdate()}},model:{value:t.row.orgIds,callback:function(s){e.$set(t.row,"orgIds",s)},expression:"scope.row.orgIds"}},e._l(e.invisibleOrgList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}],null,!1,3448022894)}),s("el-table-column",{attrs:{align:"center",label:"指派角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-select",{attrs:{size:"mini",filterable:"",clearable:"",multiple:"",placeholder:"请选择"},model:{value:t.row.roleIds,callback:function(s){e.$set(t.row,"roleIds",s)},expression:"scope.row.roleIds"}},e._l(e.invisibleRoleList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}],null,!1,937116087)})],1),s("div",{staticClass:"dialog-footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.updateTaskAssign}},[e._v("确定")])],1)],1)],1):e._e(),s("div",[e.toDoMainPage?e._e():s("deal-process-details",{attrs:{"edit-mode":!1,process:e.processItem},on:{clickReturn:e.returnAndReload}})],1)])},a=[],n=(s("8e6e"),s("ac6a"),s("456d"),s("28a5"),s("bd86")),i=(s("96cf"),s("3b8d")),o=s("d225"),c=s("b0b4"),l=s("308d"),u=s("6bb5"),d=s("4e2b"),m=s("9ab4"),p=s("60a3"),g=s("3251"),h=s("7151"),b=s("c195");function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function v(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var y=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.finishedQueryCriteria={processName:"",size:10,current:1},e.unfinishedQueryCriteria={processName:"",size:10,current:1},e.processName="",e.handingTableData=[],e.finishedTableData=[],e.handingTotal=0,e.finishedTotal=0,e.handingLoading=!1,e.finishedLoading=!1,e.createdTime="",e.createdUsername="",e.selected="handing",e.currentNodeDialog=!1,e.imgLoading=!1,e.currentNodeImg="",e.toDoMainPage=!0,e.processItem=null,e.editTaskAssignedDialog=!1,e.taskAssignedList=[],e.invisibleOrgList=[],e.invisibleUserList=[],e.invisibleRoleList=[],e.indexCustomHanding=0,e.indexCustomFinished=0,e}return Object(d["a"])(t,e),Object(c["a"])(t,[{key:"created",value:function(){var e=this;this.handingLoading=!0,this.getOngoingProcess().then((function(){e.handingLoading=!1,e.getFinishedProcess()})),this.getInvisibleDataList(g["a"].getAllOrg,"invisibleOrgList","orgId","orgName"),this.getInvisibleDataList(g["a"].getAllRole,"invisibleRoleList","roleId","roleName"),this.getInvisibleDataList(g["a"].getAllUser,"invisibleUserList","userId","userName")}},{key:"getOngoingProcess",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get(g["a"].getOngoingProcess,{params:this.unfinishedQueryCriteria});case 3:t=e.sent,s=t.data,r=s.data,a=s.status,n=s.message,a?(this.handingTableData=r.records,this.handingTotal=r.total,this.indexCustomHanding=(r.current-1)*r.size+1):this.$message.error(n),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getFinishedProcess",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get(g["a"].getFinishedProcess,{params:this.finishedQueryCriteria});case 3:t=e.sent,s=t.data,r=s.data,a=s.status,n=s.message,a?(this.finishedTableData=r.records,this.finishedTotal=r.total,this.indexCustomFinished=(r.current-1)*r.size+1):this.$message.error(n),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"searchWithTab",value:function(){var e=this;"handing"===this.selected?(this.handingLoading=!0,this.unfinishedQueryCriteria.processName=this.processName,this.getOngoingProcess().then((function(){return e.handingLoading=!1}))):(this.finishedLoading=!0,this.finishedQueryCriteria.processName=this.processName,this.getFinishedProcess().then((function(){return e.finishedLoading=!1})))}},{key:"getCurrentNode",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.currentNodeDialog=!0,this.imgLoading=!0,this.currentNodeImg="".concat(g["a"].getProcessImg,"?processInstanceId=").concat(t),this.getImage();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getInvisibleDataList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,s,r,a){var n,i,o,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(t);case 2:n=e.sent,i=n.data,o=i.data,c=i.status,l=i.message,c?this[s]=o.map((function(e){return{id:e[r],name:e[a]}})):this.$message.error(l);case 8:case"end":return e.stop()}}),e,this)})));function t(t,s,r,a){return e.apply(this,arguments)}return t}()},{key:"editTaskAssigned",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var s,r,a,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(g["a"].getRuntimeTaskAssignedList+"?processInstanceId="+t);case 2:s=e.sent,r=s.data,a=r.data,n=r.status,i=r.message,n?(this.taskAssignedList=a,this.editTaskAssignedDialog=!0):this.$message.error(i);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateTaskAssign",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkUserTaskDesign();case 3:if(t=e.sent,!t.every((function(e){return e.status}))){e.next=15;break}return e.next=7,this.$http.post(g["a"].updateAssignedGroup,this.taskAssignedList);case 7:s=e.sent,r=s.data,r.data,a=r.status,n=r.message,a?(this.$message.success(n),this.editTaskAssignedDialog=!1):this.$message.error(n),e.next=16;break;case 15:this.$message.error("节点指派不能为空");case 16:e.next=21;break;case 18:return e.prev=18,e.t0=e["catch"](0),e.abrupt("return");case 21:case"end":return e.stop()}}),e,this,[[0,18]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkUserTaskDesign",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.taskAssignedList.map((function(e){return e.userIds.length||e.roleIds.length||e.orgIds.length?v({status:!0},e):{status:!1}})));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getImage",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$nextTick((function(){var e=t.$refs["processImg"],s=e.getAttribute("process-src"),r=new XMLHttpRequest,a=b["a"].get("accessToken");r.responseType="blob",r.open("get",s,!0),r.setRequestHeader("accessToken","Bearer "+a),r.onreadystatechange=function(s){r.readyState==XMLHttpRequest.DONE&&200==r.status&&(e.src=URL.createObjectURL(r.response),e.onload=function(){URL.revokeObjectURL(e.src)}),t.imgLoading=!1},r.send(null)}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getProcessDefine",value:function(e){this.processItem=e,this.toDoMainPage=!1}},{key:"returnAndReload",value:function(){var e=this;this.toDoMainPage=!0,this.handingLoading=!0,this.getOngoingProcess().then((function(){e.getFinishedProcess(),e.handingLoading=!1}))}}]),t}(p["e"]);y=m["__decorate"]([Object(p["a"])({components:{DealProcessDetails:h["a"]},filters:{assignFilter:function(e){return e.split(",")[e.split(",").length-2]}}})],y);var k=y,w=k,x=(s("6421"),s("2877")),N=Object(x["a"])(w,r,a,!1,null,"739b12a1",null);t["default"]=N.exports},7151:function(e,t,s){"use strict";var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.detailLoading,expression:"detailLoading"}],staticClass:"deal-page-main"},[s("el-tabs",{staticStyle:{position:"relative"},attrs:{type:"card"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[e.editMode?s("el-tab-pane",{key:"current",attrs:{label:e.process.taskName,name:"currentTabPane"}},[s("el-form",{ref:"submitNodeForm",staticStyle:{"margin-top":"20px"},attrs:{model:e.submitNodeForm,"label-width":"120px",size:"small"}},[e.process.formContent?s("el-row",[s("div",{staticClass:"form-name"},[e._v("审批表单")])]):e._e(),s("q-custom-input",{ref:"customInput",attrs:{"custom-options":e.currentNodeForm}}),s("div",{staticClass:"deal-process-result"},[s("el-form-item",{attrs:{label:"处理任务：",prop:"handle",rules:{required:!0,message:"该选项为必填项",trigger:"blur"}}},[e.process.isFirst?[s("el-radio",{attrs:{label:"pass"},model:{value:e.submitNodeForm.handle,callback:function(t){e.$set(e.submitNodeForm,"handle",t)},expression:"submitNodeForm.handle"}},[e._v("重新发起")])]:[s("el-radio",{attrs:{label:"pass"},model:{value:e.submitNodeForm.handle,callback:function(t){e.$set(e.submitNodeForm,"handle",t)},expression:"submitNodeForm.handle"}},[e._v("通过 ")]),e.handleState||2!==e.process.nextTaskCount?e._e():s("el-radio",{attrs:{label:"reject"},model:{value:e.submitNodeForm.handle,callback:function(t){e.$set(e.submitNodeForm,"handle",t)},expression:"submitNodeForm.handle"}},[e._v("驳回")])]],2),s("el-form-item",{attrs:{label:"备注："}},[s("el-input",{attrs:{type:"textarea",rows:2,resize:"none"},model:{value:e.submitNodeForm.taskRemark,callback:function(t){e.$set(e.submitNodeForm,"taskRemark",t)},expression:"submitNodeForm.taskRemark"}})],1),e._e()],1)],1)],1):e._e(),e._l(e.processDefines,(function(t,r){return s("el-tab-pane",{key:r,attrs:{label:t.taskName?t.taskName:"发起",name:t.taskKey?t.taskKey+"-"+r:"startUserName"}},[s("el-form",{staticStyle:{"margin-top":"20px"},attrs:{size:"small","label-width":"120px"}},[s("div",{staticClass:"form-name"},[e._v(e._s(t.taskName?"审批表单":"申请表单"))]),t.taskKey?[t.formValue&&"null"!==t.formValue?[s("q-custom-input",{attrs:{"custom-options":JSON.parse(t.formValue),disabled:""}})]:e._e(),s("el-row",{staticClass:"partition-line"},[s("el-form-item",{staticStyle:{width:"33.3%"},attrs:{label:"处理结果："}},[s("el-input",{attrs:{size:"small",disabled:"",model:t.comment.type,placeholder:"pass"===t.comment.type?"通过":"驳回"}})],1),s("el-form-item",{attrs:{label:"审批时间："}},[s("el-input",{attrs:{placeholder:e.$moment(t.comment.time).format("YYYY-MM-DD HH:mm:ss"),disabled:""}})],1),s("el-form-item",{attrs:{label:"审批人："}},[s("el-input",{attrs:{placeholder:t.comment.userId,disabled:""}})],1),s("el-form-item",{attrs:{label:"备注："}},[s("el-input",{attrs:{type:"textarea",rows:2,resize:"none",disabled:""},model:{value:t.comment.message,callback:function(s){e.$set(t.comment,"message",s)},expression:"item.comment.message"}})],1)],1)]:[s("q-custom-input",{attrs:{"custom-options":e.startNodeForm,disabled:""}}),s("el-row",{staticClass:"partition-line"},[s("el-form-item",{attrs:{label:"申请时间："}},[s("el-input",{attrs:{disabled:""},model:{value:e.startNodeTime,callback:function(t){e.startNodeTime=t},expression:"startNodeTime"}})],1),s("el-form-item",{attrs:{label:"申请人："}},[s("el-input",{attrs:{disabled:""},model:{value:t.comment.userId,callback:function(s){e.$set(t.comment,"userId",s)},expression:"item.comment.userId"}})],1),s("el-form-item",{attrs:{label:"备注："}},[s("el-input",{attrs:{type:"textarea",rows:2,resize:"none",disabled:""},model:{value:t.comment.message,callback:function(s){e.$set(t.comment,"message",s)},expression:"item.comment.message"}})],1)],1)]],2)],1)}))],2),s("div",{staticClass:"return-back-button"},["currentTabPane"===e.currentTab?s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.dealedProcess}},[e._v("\n      提交\n    ")]):e._e(),s("el-button",{attrs:{size:"small"},on:{click:e.returnMainPage}},[e._v("返回")])],1)],1)},a=[],n=(s("96cf"),s("3b8d")),i=s("d225"),o=s("b0b4"),c=s("308d"),l=s("6bb5"),u=s("4e2b"),d=s("9ab4"),m=s("60a3"),p=s("3251"),g=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(c["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.detailLoading=!0,e.currentTab=e.editMode?"currentTabPane":"startUserName",e.processDefines=[],e.startNodeForm=[],e.startNodeTime="",e.startUserName="",e.targetUserIds=[],e.currentNodeForm=[],e.submitNodeForm={taskRemark:" ",formValue:"",targetUserIds:[],handle:"pass"},e.handleState=0,e.userInfoList=[],e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){var e=this;this.editMode?(this.dealProcess().then((function(){return e.detailLoading=!1})),this.submitNodeForm.taskId=this.process.taskId):(this.getProcessHistory(),this.getApplyFormValue().then((function(){return e.detailLoading=!1})))}},{key:"dealProcess",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get(p["a"].getProcessParameter,{params:{processInstanceId:this.process.processInstanceId,taskId:this.process.taskId}});case 3:t=e.sent,s=t.data,r=s.data,a=s.status,n=s.message,a?(this.processDefines=r.comments,this.startNodeForm=JSON.parse(r.formSubmit.formSubmitValue).map((function(e){return e.attrType?e:{name:e.title,attrType:"text",value:e.value,dataRange:{presetText:""}}})),this.startNodeTime=this.$moment(r.formSubmit.createTime).format("YYYY-MM-DD HH:mm:ss"),this.process.isFirst?this.currentNodeForm=JSON.parse(JSON.stringify(this.startNodeForm)):this.currentNodeForm=this.process.formContent?JSON.parse(this.process.formContent):[]):this.$message.error(n),e.next=14;break;case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"findUserByName",value:function(e){var t=this;this.$http.get(p["a"].getAllUserVisible,{params:{userName:e}}).then((function(e){e.data.status?t.userInfoList=e.data.data:t.$message.error(e.data.message)}))}},{key:"dealedProcess",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs["submitNodeForm"].validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(s){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s){e.next=12;break}return e.next=3,t.$refs.customInput.formValidation();case 3:if(r=e.sent,!r){e.next=9;break}t.submitNodeForm.formValue=JSON.stringify(t.currentNodeForm),t.$http.post(p["a"].handleTask,t.submitNodeForm).then((function(e){e.data.status?(t.$message.success("流程处理成功！"),t.returnMainPage()):t.$message.error(e.data.message)})),e.next=10;break;case 9:return e.abrupt("return",!1);case 10:e.next=13;break;case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getProcessHistory",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$http.get("".concat(p["a"].getProcessDetailInfo).concat(this.process.processInstanceId)).then((function(e){t.processDefines=e.data}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getApplyFormValue",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$http.get("".concat(p["a"].getApplyFormValue).concat(this.process.processInstanceId)).then((function(e){t.startNodeForm=JSON.parse(e.data.formSubmitValue).map((function(e){return e.attrType?e:{name:e.title,attrType:"text",value:e.value,dataRange:{presetText:""}}})),t.startNodeTime=t.$moment(e.data.createTime).format("YYYY-MM-DD HH:mm:ss"),t.startUserName=e.data.userName}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"returnMainPage",value:function(){this.$emit("clickReturn")}}]),t}(m["e"]);d["__decorate"]([Object(m["d"])({type:Object,default:function(){},required:!0})],g.prototype,"process",void 0),d["__decorate"]([Object(m["d"])({type:Boolean,default:!0})],g.prototype,"editMode",void 0),g=d["__decorate"]([Object(m["a"])({})],g);var h=g,b=h,f=(s("bbfe"),s("2877")),v=Object(f["a"])(b,r,a,!1,null,"2328e79a",null);t["a"]=v.exports},ab39:function(e,t,s){},bbfe:function(e,t,s){"use strict";var r=s("5110"),a=s.n(r);a.a}}]);
//# sourceMappingURL=chunk-e2d3f516.9ad15f17.js.map