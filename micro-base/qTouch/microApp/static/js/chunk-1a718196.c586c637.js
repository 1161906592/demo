(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-1a718196"],{"0797":function(e,t,a){"use strict";var s={getCodesListByCatalog:"/admin/code/info/list/catalog/",getInspectQRCodes:"/admin/catalog/tree",getSensorsListByPart:"/api/partsSensorRelation/getSensorIds",getSensorInfoById:"/api/sensor/getSensorById",getPartsList:"/admin/parts/getList",getCodeById:"/api/sensor/getSensorById",updateCode:"/api/sensor/getSensorById",saveCode:"/api/sensor/getSensorById",deleteCode:"/api/sensor/getSensorById",addTemplateNode:"/api/sensor/getSensorById",previewCode:"/api/sensor/getSensorById",deleteTemplate:"/api/sensor/getSensorById",getPlansListByCatalog:"/api/sensor/getSensorById",getInspectPlans:"/api/sensor/getSensorById",catalog:{add:"/admin/catalog/add",update:"/admin/catalog/update",delete:"/admin/catalog/delete/",tree:"/admin/catalog/tree",typeTree:"/admin/catalog/tree/"},qrCode:{listById:"/admin/code/info/list/catalog/",save:"/admin/code/info/save",update:"/admin/code/info/update",delete:"/admin/code/info/delete/",preview:"/admin/code/info/preview/",detail:"/admin/code/info/detail/",isBinded:"/admin/code/info/verify/device/"},template:{list:"/admin/inspect/template/list/catalog/",listForOrg:"/admin/inspect/template/getInspectTemplateByOrgId",detail:"/admin/inspect/template/get/",save:"/admin/inspect/template/saveTemplate",delete:"/admin/inspect/template/"},personGroup:{group:{add:"/admin/person/group/add",all:"/admin/person/group/all",list:"/admin/person/group/list",delete:"/admin/person/group/delete/",update:"/admin/person/group/update"},person:{list:"/admin/inspect/person/list/",add:"/admin/inspect/person/add",update:"/admin/inspect/person/put",delete:"/admin/inspect/person/delete/"}},record:{list:"/admin/inspect/record/pagination",save:"/admin/inspect/record/save"},other:{getAllUserList:"/admin/getUserList",getAllUser:"/admin/processDesigner/public/visible/getAllUser",getAllEventType:"/admin/event/type/tree"}};t["a"]=s},3434:function(e,t,a){},"3dde":function(e,t,a){"use strict";var s=a("3434"),i=a.n(s);i.a},"8e04":function(e,t,a){"use strict";var s=a("e77a"),i=a.n(s);i.a},e77a:function(e,t,a){},fffe:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"main-content"},[a("el-form",{attrs:{"label-width":"120px"},model:{value:e.codeBasicForm,callback:function(t){e.codeBasicForm=t},expression:"codeBasicForm"}},[a("el-row",{staticClass:"line-style"},[a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"二维码名称：",prop:"codeName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.codeBasicForm.codeName,callback:function(t){e.$set(e.codeBasicForm,"codeName",t)},expression:"codeBasicForm.codeName"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"定位：",prop:"coordinate"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",placeholder:"经纬度",disabled:e.disabled,"auto-complete":"off"},model:{value:e.codeBasicForm.coordinate,callback:function(t){e.$set(e.codeBasicForm,"coordinate",t)},expression:"codeBasicForm.coordinate"}},[a("el-button",{attrs:{slot:"append",size:"small",icon:"el-icon-location"},slot:"append"})],1)],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"地址：",prop:"location"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled},model:{value:e.codeBasicForm.location,callback:function(t){e.$set(e.codeBasicForm,"location",t)},expression:"codeBasicForm.location"}})],1)],1)],1),a("el-row",{staticClass:"line-style",staticStyle:{"border-bottom":"1px solid #e1f3d8"}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"备注：",prop:"remark"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",maxlength:255,placeholder:"备注",disabled:e.disabled,"auto-complete":"off"},model:{value:e.codeBasicForm.remark,callback:function(t){e.$set(e.codeBasicForm,"remark",t)},expression:"codeBasicForm.remark"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"有效半径：",prop:"effectiveRadius"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled},model:{value:e.codeBasicForm.effectiveRadius,callback:function(t){e.$set(e.codeBasicForm,"effectiveRadius",t)},expression:"codeBasicForm.effectiveRadius"}})],1)],1)],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}],staticClass:"line-style"},[a("el-col",{staticClass:"line-item-style",staticStyle:{"margin-left":"38px"},attrs:{span:12}},[e._v("关联设备：\n          "),a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(t){e.partChoose=!0}}},[e._v("请选择")])],1)],1)],1),a("el-form",{attrs:{"label-width":"120px"},model:{value:e.bindPartForm,callback:function(t){e.bindPartForm=t},expression:"bindPartForm"}},[a("el-row",[a("el-col",{attrs:{span:14}},[a("el-row",{staticClass:"line-style"},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"设备名称：",prop:"codePartName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.bindPartForm.partsName,callback:function(t){e.$set(e.bindPartForm,"partsName",t)},expression:"bindPartForm.partsName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"设备类型：",prop:"codePartName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.bindPartForm.partsType,callback:function(t){e.$set(e.bindPartForm,"partsType",t)},expression:"bindPartForm.partsType"}})],1)],1)],1),a("el-row",{staticClass:"line-style"},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"设备编码：",prop:"codePartCode"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.bindPartForm.partsNum,callback:function(t){e.$set(e.bindPartForm,"partsNum",t)},expression:"bindPartForm.partsNum"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"生产日期：",prop:"codePartExp"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.bindPartForm.productionTime,callback:function(t){e.$set(e.bindPartForm,"productionTime",t)},expression:"bindPartForm.productionTime"}})],1)],1)],1),a("el-row",{staticClass:"line-style"},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"生产厂家：",prop:"codePartManufacturers"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.bindPartForm.producer,callback:function(t){e.$set(e.bindPartForm,"producer",t)},expression:"bindPartForm.producer"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"设备状态：",prop:"codePartStatus"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.bindPartForm.partsStatus,callback:function(t){e.$set(e.bindPartForm,"partsStatus",t)},expression:"bindPartForm.partsStatus"}})],1)],1)],1),a("el-row",{staticClass:"line-style"},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"安装日期：",prop:"codePartInstallTime"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",disabled:e.disabled,"auto-complete":"off"},model:{value:e.bindPartForm.installTime,callback:function(t){e.$set(e.bindPartForm,"installTime",t)},expression:"bindPartForm.installTime"}})],1)],1)],1)],1),a("el-col",{attrs:{span:10}},[a("span",{staticStyle:{"font-size":"14px","font-weight":"bold","line-height":"30px",float:"left","margin-top":"10px"}},[e._v("设备图片：")]),a("img",{directives:[{name:"show",rawName:"v-show",value:e.bindPartForm.pic,expression:"bindPartForm.pic"}],attrs:{src:e.bindPartForm.pic,width:"220px",height:"140px"}})])],1),a("el-row",[a("sensors-info-list",{attrs:{"part-id":e.bindPartForm.id}})],1)],1),a("el-form",{attrs:{"label-width":"120px"},model:{value:e.bindTemplateForm,callback:function(t){e.bindTemplateForm=t},expression:"bindTemplateForm"}},[a("el-row",{staticClass:"line-style"},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"巡检方案："}})],1),e._l(e.bindTemplateForm,(function(t,s){return a("el-row",{key:s,staticClass:"line-style"},[a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"方案名称："}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small","auto-complete":"off"},model:{value:t.templateName,callback:function(a){e.$set(t,"templateName",a)},expression:"item.templateName"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"方案备注："}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small","auto-complete":"off"},model:{value:t.templateRemark,callback:function(a){e.$set(t,"templateRemark",a)},expression:"item.templateRemark"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{staticClass:"line-item-style",attrs:{label:"人员组："}},[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small","auto-complete":"off"},model:{value:t.personGroups,callback:function(a){e.$set(t,"personGroups",a)},expression:"item.personGroups"}})],1)],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}],attrs:{span:3}},[a("el-form-item",{staticClass:"line-item-style",staticStyle:{float:"left"},attrs:{"label-width":"0"}},[a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.editTemplatePersonGroup(t,s)}}},[e._v("编辑")]),a("span",[e._v(" / ")]),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.removeTemplatePersonGroup(t)}}},[e._v("移除")])],1)],1)],1)})),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}]},[a("el-form-item",[a("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.addTemplatePersonGroup()}}},[e._v("添加巡检方案")]),a("el-button",{attrs:{size:"small",icon:"el-icon-document-checked"},on:{click:function(t){return e.saveCodeInfo()}}},[e._v("保存二维码")])],1)],1)],2)],1),a("el-button",{staticStyle:{position:"absolute",right:"20px",top:"20px"},attrs:{size:"small",type:"primary"},on:{click:function(t){return e.$router.back()}}},[e._v("返回")]),a("el-dialog",{staticStyle:{"min-height":"600px"},attrs:{title:"设备/设备列表",visible:e.partChoose,"lock-scroll":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.partChoose=t}}},[a("parts-list-table",{on:{chosenPartInfo:e.fillPartForm}})],1),a("el-dialog",{attrs:{visible:e.templateEditDialog,width:"1200px","close-on-click-modal":!1},on:{"update:visible":function(t){e.templateEditDialog=t}}},[e.templateEditDialog?a("code-edit-step",{attrs:{active:e.stepActive,item:e.templateFormItem},on:{selectedTAG:e.fillTemplateForm}}):e._e()],1)],1)},i=[],l=(a("7f7f"),a("d225")),o=a("b0b4"),r=a("308d"),n=a("6bb5"),d=a("4e2b"),c=a("9ab4"),p=a("60a3"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"parts-list-table"},[a("el-table",{attrs:{data:e.partsTableList,"highlight-current-row":"",size:"mini",height:"400"},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"100"}}),a("el-table-column",{attrs:{align:"center",prop:"partsName",label:"设备名",width:"140"}}),a("el-table-column",{attrs:{align:"center",prop:"partsNum",label:"设备编码"}}),a("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("partsStatusFilter")(t.row.partsStatus)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"是否绑定"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("bindStatusFilter")(t.row.isBind)))])]}}])}),a("el-table-column",{attrs:{align:"center",prop:"producer",label:"生产厂家"}}),a("el-table-column",{attrs:{align:"center",prop:"productionTime",label:"生产日期",width:"180"}}),a("el-table-column",{attrs:{align:"center",prop:"installTime",label:"安装日期",width:"180"}})],1),a("div",{staticClass:"block",staticStyle:{float:"bottom",margin:"12px",width:"100%",height:"30px"}},[a("el-pagination",{staticStyle:{float:"right","margin-top":"10px",height:"50px"},attrs:{small:"",background:"","current-page":e.searchDTO.page,"page-size":e.searchDTO.rows,layout:"total, prev, pager, next, jumper",total:e.searchDTO.total},on:{"update:currentPage":function(t){return e.$set(e.searchDTO,"page",t)},"update:current-page":function(t){return e.$set(e.searchDTO,"page",t)},"current-change":e.getPartsList}})],1)],1)},u=[],b=a("0797"),f=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(r["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.partsTableList=[],e.searchDTO={page:1,rows:10,total:0,condition:""},e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"handleCurrentChange",value:function(e){this.$emit("chosenPartInfo",e)}},{key:"getPartsList",value:function(){var e=this;this.$http.post(b["a"].getPartsList,this.searchDTO).then((function(t){t.data.status?(e.partsTableList=t.data.list,e.searchDTO.page=t.data.currentPage,e.searchDTO.rows=t.data.pageSize,e.searchDTO.total=t.data.totalResult):e.$message.error(t.data.message)}))}},{key:"mounted",value:function(){this.getPartsList()}}]),t}(p["e"]);f=c["__decorate"]([Object(p["a"])({filters:{partsStatusFilter:function(e){return 1===e?"有效":"无效"},bindStatusFilter:function(e){return 1===e?"已绑定":"未绑定"}}})],f);var h=f,g=h,v=(a("3dde"),a("2877")),y=Object(v["a"])(g,m,u,!1,null,"1f680219",null),F=y.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{ref:"sensorsListTable",attrs:{data:e.sensorsInfoListData,"tooltip-effect":"dark",size:"mini"}},[a("el-table-column",{attrs:{label:"序号",type:"index",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"sensorName",label:"传感器名称",align:"center",width:"240"}}),a("el-table-column",{attrs:{prop:"sensorNumber",label:"传感器编号",align:"center",width:"200"}}),a("el-table-column",{attrs:{prop:"sensorType",label:"传感器类型",align:"center",width:"200"}}),a("el-table-column",{attrs:{prop:"companyName",label:"生产商",align:"center",width:"200"}})],1)},w=[],I=(a("c5f6"),a("ac6a"),function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(r["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.sensorsInfoListData=[],e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"getSensorsInfoList",value:function(e){var t=this;this.$http.get(b["a"].getSensorsListByPart,{params:{partsId:e}}).then((function(e){e.status?e.data.forEach((function(e){t.$http.get(b["a"].getSensorInfoById,{params:{id:e}}).then((function(e){e.data.status?t.sensorsInfoListData.push(e.data.sensor):t.$message.error(e.data.message)}))})):t.$message.error(e.data.message)}))}},{key:"setPartId",value:function(e){this.getSensorsInfoList(e)}}]),t}(p["e"]));c["__decorate"]([Object(p["d"])({type:Number,required:!0,default:0})],I.prototype,"partId",void 0),c["__decorate"]([Object(p["f"])("partId",{deep:!1})],I.prototype,"setPartId",null),I=c["__decorate"]([p["a"]],I);var k=I,T=k,x=Object(v["a"])(T,P,w,!1,null,"2cae738e",null),C=x.exports,S=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(r["a"])(this,Object(n["a"])(t).apply(this,arguments)),e.codePreData={},e.pageTitle="",e.disabled=!1,e.codeBasicForm={},e.bindPartForm={},e.bindTemplateForm=[],e.partChoose=!1,e.templateEditDialog=!1,e.templateFormIndex=0,e.stepActive=1,e.templateFormItem={},e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"getCodeInfo",value:function(){var e=this;this.$http.get(b["a"].getCodeById+this.codePreData.codeId).then((function(t){t.data.status?(e.codeBasicForm=t.data.data,e.bindPartForm=t.data.data.deviceInfo,e.bindTemplateForm=t.data.data.templatePersonGroup):e.$message.error(t.data.message)}))}},{key:"fillPartForm",value:function(e){this.bindPartForm=e,this.partChoose=!1,1===e.partsStatus?this.bindPartForm.partsStatus="有效":this.bindPartForm.partsStatus="无效"}},{key:"fillTemplateForm",value:function(e){if(this.templateEditDialog=!1,this.bindTemplateForm[this.templateFormIndex].templateName=e.planInfo.name,this.bindTemplateForm[this.templateFormIndex].templateId=e.planInfo.id,this.bindTemplateForm[this.templateFormIndex].templateRemark=e.planInfo.remark,this.bindTemplateForm[this.templateFormIndex].personGroups=e.personGroups[0].groupName,this.bindTemplateForm[this.templateFormIndex].personGroupIds.push(e.personGroups[0].id),e.personGroups.length>1)for(var t=1;t<e.personGroups.length;t++)this.bindTemplateForm[this.templateFormIndex].personGroups=this.bindTemplateForm[this.templateFormIndex].personGroups+","+e.personGroups[t].groupName,this.bindTemplateForm[this.templateFormIndex].personGroupIds.push(e.personGroups[t].id)}},{key:"addTemplatePersonGroup",value:function(){this.bindTemplateForm.push({templateId:"",personGroupIds:[]})}},{key:"editTemplatePersonGroup",value:function(e,t){this.stepActive=1,this.templateFormItem=e,this.templateFormIndex=t,this.templateEditDialog=!0}},{key:"removeTemplatePersonGroup",value:function(e){var t=this.bindTemplateForm.indexOf(e);-1!==t&&this.bindTemplateForm.splice(t,1)}},{key:"saveCodeInfo",value:function(){var e=this,t={};t.catalogId=this.codePreData.catalogId,t.codeName=this.codeBasicForm.codeName,t.coordinate=this.codeBasicForm.coordinate,t.location=this.codeBasicForm.location,t.remark=this.codeBasicForm.remark,t.effectiveRadius=this.codeBasicForm.effectiveRadius,t.deviceInfoId=this.bindPartForm.id,t.templatePersonGroup=this.bindTemplateForm,"edit"===this.codePreData.mode?(t.id=this.codePreData.codeId,this.$http.post(b["a"].updateCode,t).then((function(t){t.data.status?(e.$message.success("修改二维码信息成功！"),e.changeSingleCodeVisible()):e.$message.error(t.data.message)}))):this.$http.post(b["a"].saveCode,t).then((function(t){t.data.status?(e.$message.success("保存二维码信息成功！"),e.changeSingleCodeVisible()):e.$message.error(t.data.message)}))}},{key:"changeSingleCodeVisible",value:function(){this.$emit("changeVisible",!1)}},{key:"changeEditMode",value:function(){"edit"==this.codePreData.mode?(this.pageTitle="修改二维码",this.getCodeInfo()):"view"===this.codePreData.mode?(this.pageTitle="二维码详情",this.getCodeInfo(),this.disabled=!0):this.pageTitle="新建二维码"}},{key:"created",value:function(){var e=this.$route.params.preData;e?(this.codePreData=JSON.parse(e),this.changeEditMode()):this.$router.back()}}]),t}(p["e"]);S=c["__decorate"]([Object(p["a"])({components:{PartsListTable:F,SensorsInfoList:C}})],S);var B=S,$=B,_=(a("8e04"),Object(v["a"])($,s,i,!1,null,"1159266a",null));t["default"]=_.exports}}]);
//# sourceMappingURL=chunk-1a718196.c586c637.js.map