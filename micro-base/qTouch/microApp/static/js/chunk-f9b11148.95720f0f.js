(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-f9b11148"],{"0a49":function(e,t,a){var n=a("9b43"),i=a("626a"),s=a("4bf8"),r=a("9def"),l=a("cd1c");e.exports=function(e,t){var a=1==e,o=2==e,c=3==e,u=4==e,d=6==e,p=5==e||d,h=t||l;return function(t,l,f){for(var b,m,v=s(t),g=i(v),y=n(l,f,3),x=r(g.length),k=0,O=a?h(t,x):o?h(t,0):void 0;x>k;k++)if((p||k in g)&&(b=g[k],m=y(b,k,v),e))if(a)O[k]=m;else if(m)switch(e){case 3:return!0;case 5:return b;case 6:return k;case 2:O.push(b)}else if(u)return!1;return d?-1:c||u?u:O}}},"0b0b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(e.whichComponent,{tag:"component",attrs:{data:e.data,ruleOptions:e.ruleOptions,baseTypeOptions:e.baseTypeOptions},on:{toForm:e.toForm,toDetail:e.toDetail,toList:e.toList}})},i=[],s=(a("ac6a"),a("96cf"),a("3b8d")),r=a("d225"),l=a("b0b4"),o=a("308d"),c=a("6bb5"),u=a("4e2b"),d=a("9ab4"),p=a("60a3"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("q-left-right-layout",{attrs:{"left-title":"组织机构树","right-title":(e.curNode.name||"")+"规则列表"}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("el-input",{staticStyle:{"margin-bottom":"10px",padding:"0 10px"},attrs:{placeholder:"输入关键字进行过滤",maxlength:100,size:"small"},model:{value:e.treeMessage.filterText,callback:function(t){e.$set(e.treeMessage,"filterText",t)},expression:"treeMessage.filterText"}}),a("div",{staticClass:"tree-content"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.treeMessage.data,props:e.treeMessage.defaultProps,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1)],1),a("div",{staticClass:"right",attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"header"},[a("div",{staticClass:"input-wrap"},[a("el-input",{staticClass:"input",attrs:{size:"small",placeholder:"请输入名称或编码"},model:{value:e.vague,callback:function(t){e.vague=t},expression:"vague"}}),a("el-select",{staticClass:"input",attrs:{size:"small",clearable:"",placeholder:"适用范围"},on:{change:e.getOrgBindRuleList},model:{value:e.baseTypeCode,callback:function(t){e.baseTypeCode=t},expression:"baseTypeCode"}},e._l(e.baseTypeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.code}})})),1),a("q-search-button",{on:{click:e.getOrgBindRuleList}})],1),a("div",{staticClass:"btn"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.handleToForm()}}},[e._v("添加")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",icon:"el-icon-document-copy",disabled:!e.curNode.parentId},on:{click:e.handleCloneRule}},[e._v("继承")])],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}]},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"20px","min-height":"calc(100vh - 294px)"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",label:"序号","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"codeName",label:"规则名称","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"code",label:"规则编码","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"baseTypeName",label:"适用范围","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"typeDetailName",label:"适用类型","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"preRuleExpress",label:"规则预览","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view",title:"查看"},on:{click:function(a){return e.handleToDetail(t.row.id)}}},[e._v("查看")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit",title:"编辑"},on:{click:function(a){return e.handleToForm(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete",title:"解绑"},on:{click:function(a){return e.handleDeleteRule(t.row)}}},[e._v("解绑")])]}}])})],1)],1)])])],1)},f=[],b=a("ccd1"),m=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.treeMessage={filterText:"",data:[],defaultProps:{children:"children",label:"name",checkStrictly:!0}},e.curNode={},e.vague="",e.baseTypeCode="",e.tableLoading=!1,e.tableData=[],e}return Object(u["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.getOrgTreeData()}},{key:"handleNodeClick",value:function(e){this.curNode=JSON.parse(JSON.stringify(e)),this.vague="",this.baseTypeCode="",this.getOrgBindRuleList()}},{key:"setFilterText",value:function(e){this.$refs.tree.filter(e)}},{key:"filterNode",value:function(e,t){return!e||-1!==t[this.treeMessage.defaultProps.label].indexOf(e)}},{key:"getOrgTreeData",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i,s,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(b["a"].getOrgTreeData);case 2:t=e.sent,a=t.data,n=a.status,i=a.data,s=a.message,n?(this.treeMessage.data=i,i.length&&(this.curNode=i[0]),this.data&&(this.curNode=this.data.curNode),this.getOrgBindRuleList(),this.$nextTick((function(){r.$refs.tree.setCurrentKey(r.curNode.id)}))):this.$message.error(s);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getOrgBindRuleList",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.tableLoading=!0,e.prev=1,e.next=4,this.$http.post(b["a"].getOrgBindRuleList,{vague:this.vague,orgId:this.curNode.id,baseTypeCode:this.baseTypeCode});case 4:t=e.sent,a=t.data,n=a.status,i=a.data,s=a.message,n?this.tableData=i:this.$message.error(s);case 10:return e.prev=10,this.tableLoading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,,10,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleToForm",value:function(e){this.$emit("toForm",{curNode:this.curNode,rule:e})}},{key:"handleToDetail",value:function(e){this.$emit("toDetail",{curNode:this.curNode,ruleId:e})}},{key:"handleDeleteRule",value:function(e){var t=this;this.$confirm("确认解绑?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.doDeleteRule(e.id)}))}},{key:"doDeleteRule",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(b["a"].unbindRule+t);case 2:a=e.sent,n=a.data,i=n.status,s=n.message,i?(this.getOrgBindRuleList(),this.$message.success("解绑成功")):this.$message.error(s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleCloneRule",value:function(){var e=this;this.$confirm("确认继承父节点编码规则?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.doCloneRule()}))}},{key:"doCloneRule",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(b["a"].cloneRule+this.curNode.id+"/"+this.curNode.parentId);case 2:t=e.sent,a=t.data,n=a.status,i=a.message,n?(this.getOrgBindRuleList(),this.$message.success("继承成功")):this.$message.error(i);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(p["e"]);d["__decorate"]([Object(p["d"])({required:!0})],m.prototype,"data",void 0),d["__decorate"]([Object(p["d"])({type:Array,required:!0})],m.prototype,"baseTypeOptions",void 0),d["__decorate"]([Object(p["f"])("treeMessage.filterText")],m.prototype,"setFilterText",null),m=d["__decorate"]([Object(p["a"])({})],m);var v=m,g=v,y=(a("d5a0"),a("2877")),x=Object(y["a"])(g,h,f,!1,null,"6fb4c5bc",null),k=x.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"top"},[a("div",{staticClass:"title"},[a("el-icon",{staticClass:"el-icon-menu icon-blue"}),e._v("基本信息")],1),a("div",{staticClass:"inline"},[a("el-form",{ref:"form",staticClass:"basic",attrs:{model:e.form,rules:e.formRules,size:"small","label-width":"90px"}},[a("el-form-item",{attrs:{label:"组织机构:",prop:"orgName"}},[a("el-input",{staticClass:"input",attrs:{disabled:""},model:{value:e.form.orgName,callback:function(t){e.$set(e.form,"orgName",t)},expression:"form.orgName"}})],1),a("el-form-item",{attrs:{label:"数据类型:",prop:"baseType"}},[a("el-cascader",{staticClass:"input",attrs:{size:"small",placeholder:"数据类型",options:e.baseTypeOptions,props:{label:"name",value:"id",checkStrictly:!0}},on:{change:function(t){return e.validateField("baseType")}},model:{value:e.form.baseType,callback:function(t){e.$set(e.form,"baseType",t)},expression:"form.baseType"}})],1),a("el-form-item",{attrs:{label:"编码规则:",prop:"codeRule"}},[a("el-cascader",{ref:"rule",staticClass:"input",attrs:{placeholder:"编码规则",options:e.ruleOptions,props:{label:"codeName",value:"id",checkStrictly:!0}},on:{change:e.handleSelectRule},model:{value:e.form.codeRule,callback:function(t){e.$set(e.form,"codeRule",t)},expression:"form.codeRule"}})],1)],1),a("div",[e.data.rule?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"primary"},on:{click:e.handleAdd}},[e._v("保存")]):a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"primary"},on:{click:e.handleAdd}},[e._v("添加")])],1)],1)]),a("div",[a("div",{staticClass:"title"},[a("el-icon",{staticClass:"el-icon-menu icon-blue"}),e._v("编码规则")],1),a("div",{staticClass:"list"},[e.ruleExpressJson?a("code-rules-config",{staticStyle:{"margin-top":"20px"},attrs:{"expression-json":e.ruleExpressJson,disabled:""}}):e._e()],1)]),a("el-button",{staticClass:"back",attrs:{size:"small"},on:{click:e.handleBack}},[e._v("返回")])],1)},C=[],w=(a("8e6e"),a("456d"),a("7514"),a("7f7f"),a("bd86")),R=a("b56a");function _(e,t,a){var n=[],i=!1;function s(t){for(var r=0;r<t.length;r++){if(n.push(t[r].id),t[r][a]===e)return void(i=!0);if(t[r].children&&t[r].children.length&&s(t[r].children),i)return;n.pop()}}return s(t),n}var T=_;function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){Object(w["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={},e.formRules={codeRule:{required:!0,message:"请选择编码规则",trigger:"blur"},baseType:{required:!0,message:"请选择数据类型",trigger:"blur"}},e.ruleExpressJson="",e}return Object(u["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.curNode=this.data.curNode;var e=this.data.rule;this.form=I({orgName:this.curNode.name},e?{baseType:T(e.typeDetailId,this.baseTypeOptions,"id"),codeRule:T(e.code,this.ruleOptions,"code")}:{}),e&&(this.ruleExpressJson=e.preRuleExpressJson)}},{key:"handleBack",value:function(){this.$emit("toList")}},{key:"handleSelectRule",value:function(){this.ruleExpressJson=this.$refs.rule.getCheckedNodes()[0].data.preRuleExpressJson,this.validateField("codeRule")}},{key:"validateField",value:function(e){var t=this;this.$nextTick((function(){t.$refs.form.validateField(e,(function(){}))}))}},{key:"handleAdd",value:function(){var e=this;this.$refs.form.validate((function(t){if(t){var a=e.form.baseType[0],n=e.baseTypeOptions.find((function(e){return e.baseTypeId===a})).code,i=e.form.baseType[e.form.baseType.length-1],s=e.form.codeRule[e.form.codeRule.length-1];e.doBindRule({baseTypeCode:n,typeDetailId:i,codeRuleId:s})}}))}},{key:"doBindRule",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.post(this.data.rule?b["a"].updateBindRule:b["a"].bindRule,I({},t,{orgId:this.curNode.id,id:this.data.rule?this.data.rule.id:void 0}));case 2:a=e.sent,n=a.data,i=n.status,s=n.message,i?this.$message.success("保存成功"):this.$message.error(s);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(p["e"]);d["__decorate"]([Object(p["d"])({type:Object,required:!0})],$.prototype,"data",void 0),d["__decorate"]([Object(p["d"])({type:Array,required:!0})],$.prototype,"baseTypeOptions",void 0),d["__decorate"]([Object(p["d"])({type:Array,required:!0})],$.prototype,"ruleOptions",void 0),$=d["__decorate"]([Object(p["a"])({components:{CodeRulesConfig:R["a"]}})],$);var N=$,F=N,B=(a("db8e"),Object(y["a"])(F,O,C,!1,null,"1e6cad9c",null)),S=B.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"top"},[a("div",{staticClass:"title"},[a("el-icon",{staticClass:"el-icon-menu icon-blue"}),e._v("基本信息")],1),a("div",{staticClass:"inline",staticStyle:{"margin-top":"20px"}},[a("div",[a("div",{staticClass:"label"},[e._v("组织机构:")]),a("el-input",{staticClass:"input",attrs:{disabled:"",size:"small"},model:{value:e.form.orgName,callback:function(t){e.$set(e.form,"orgName",t)},expression:"form.orgName"}})],1),a("div",{staticClass:"types"},[a("div",{staticClass:"label"},[e._v("数据类型:")]),a("div",e._l(e.form.bingTypes,(function(t,n){return a("div",{key:n,staticClass:"type"},[e._v(e._s(t.baseTypeName))])})),0)])])]),a("div",[a("div",{staticClass:"title"},[a("el-icon",{staticClass:"el-icon-menu icon-blue"}),e._v("编码规则")],1),a("div",{staticClass:"inline"},[a("div",[a("div",{staticClass:"label"},[e._v("规则名称:")]),a("el-input",{staticClass:"input",attrs:{disabled:"",size:"small"},model:{value:e.form.codeName,callback:function(t){e.$set(e.form,"codeName",t)},expression:"form.codeName"}})],1),a("div",[a("div",{staticClass:"label"},[e._v("规则编码:")]),a("el-input",{staticClass:"input",attrs:{disabled:"",size:"small"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),a("div",[a("div",{staticClass:"label"},[e._v("父规则名称:")]),a("el-input",{staticClass:"input",attrs:{disabled:"",size:"small"},model:{value:e.form.parentName,callback:function(t){e.$set(e.form,"parentName",t)},expression:"form.parentName"}})],1)]),a("div",{staticClass:"inline"},[a("div",[a("div",{staticClass:"label"},[e._v("规则介绍:")]),a("el-input",{staticClass:"input",attrs:{disabled:"",size:"small"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("div",[a("div",{staticClass:"label"},[e._v("规则预览:")]),a("el-input",{staticClass:"input",attrs:{disabled:"",size:"small"},model:{value:e.form.preRuleExpress,callback:function(t){e.$set(e.form,"preRuleExpress",t)},expression:"form.preRuleExpress"}})],1),a("div")]),e.form.preRuleExpressJson?a("code-rules-config",{staticStyle:{"margin-top":"20px"},attrs:{"expression-json":e.form.preRuleExpressJson,disabled:"","header-visible":!1}}):e._e()],1),a("el-button",{staticClass:"back",attrs:{size:"small"},on:{click:e.handleBack}},[e._v("返回")])],1)},D=[],L=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.form={bingTypes:[]},e}return Object(u["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.data.ruleId&&this.getBindRuleDetail()}},{key:"handleBack",value:function(){this.$emit("toList")}},{key:"getBindRuleDetail",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(b["a"].getBindRuleDetail+this.data.ruleId);case 2:t=e.sent,a=t.data,n=a.status,i=a.data,s=a.message,n?this.form=i:this.$message.error(s);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(p["e"]);d["__decorate"]([Object(p["d"])({type:Object,required:!0})],L.prototype,"data",void 0),L=d["__decorate"]([Object(p["a"])({components:{CodeRulesConfig:R["a"]}})],L);var z=L,J=z,V=(a("617d"),Object(y["a"])(J,E,D,!1,null,"76cf33b2",null)),M=V.exports,P=a("4791"),q=function(e){function t(){var e;return Object(r["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.whichComponent="CodeRuleBindList",e.data=null,e.ruleOptions=[],e.baseTypeOptions=[],e}return Object(u["a"])(t,e),Object(l["a"])(t,[{key:"toForm",value:function(e){this.data=e,this.whichComponent="CodeRuleBindForm"}},{key:"toDetail",value:function(e){this.data=e,this.whichComponent="CodeRuleBindView"}},{key:"toList",value:function(){this.whichComponent="CodeRuleBindList"}},{key:"created",value:function(){this.getRuleTree(),this.getBaseTypeList()}},{key:"getRuleTree",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(b["a"].getRuleTree);case 2:t=e.sent,a=t.data,n=a.status,i=a.data,s=a.message,n?(this.ruleOptions=i,Object(P["a"])(this.ruleOptions)):this.$message.error(s);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getBaseTypeList",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get(b["a"].getBaseTypeList);case 2:t=e.sent,a=t.data,n=a.status,i=a.data,s=a.message,n?(i.forEach((function(e){e.disabled=!0})),Object(P["a"])(i),this.baseTypeOptions=i):this.$message.error(s);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(p["e"]);q=d["__decorate"]([Object(p["a"])({components:{CodeRuleBindList:k,CodeRuleBindForm:S,CodeRuleBindView:M}})],q);var A=q,W=A,K=Object(y["a"])(W,n,i,!1,null,"539829bc",null);t["default"]=K.exports},"0f82":function(e,t,a){},"18da":function(e,t,a){},"1d70":function(e,t,a){},"1e1e":function(e,t,a){"use strict";var n=a("0f82"),i=a.n(n);i.a},4791:function(e,t,a){"use strict";a("ac6a");function n(e){e.forEach((function(e){e.children&&e.children.length?n(e.children):delete e.children}))}t["a"]=n},"617d":function(e,t,a){"use strict";var n=a("1d70"),i=a.n(n);i.a},7514:function(e,t,a){"use strict";var n=a("5ca1"),i=a("0a49")(5),s="find",r=!0;s in[]&&Array(1)[s]((function(){r=!1})),n(n.P+n.F*r,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(s)},b56a:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.headerVisible&&e.form.selectConditions.length?a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[e._v("规则预览:")]),a("div",{staticClass:"rule"},[e._v("\n      "+e._s(e.preRuleExpress)+"\n    ")])]):e._e(),a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"0px",size:"mini"},nativeOn:{click:function(t){return e.handleFocusRuleInput(e.cursorIndex)}}},[a("div",{staticClass:"condition-section",class:{focus:null===e.cursorIndex&&e.keyboardFocus&&!e.widgetFocus,disabled:e.disabled},on:{click:function(t){return t.target!==t.currentTarget?null:(t.stopPropagation(),e.handleFocusRuleInput(null))}}},[e._l(e.form.selectConditions,(function(t,n){return[a("div",{key:"a"+n,staticClass:"cursor",class:{focus:e.cursorIndex===n&&e.keyboardFocus&&!e.widgetFocus},on:{click:function(t){return t.stopPropagation(),e.handleFocusRuleInput(n)}}}),a("div",{key:"b"+n},["area"===t.type?a("div",{staticClass:"token"},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),a("el-form-item",{attrs:{prop:"selectConditions."+n+".value",rules:{required:!0,message:" ",trigger:["blur","change"]}}},[a("el-select",{staticStyle:{width:"256px"},attrs:{multiple:"",size:"mini",disabled:e.disabled},on:{"visible-change":function(t){return e.handleFocusRuleInput(e.cursorIndex)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(e.areaOptions,(function(t,n){return a("el-option",{key:n,attrs:{label:t.label,value:n}},[e._v(e._s(t.label))])})),1)],1)],1):"baseData"===t.type?a("div",{staticClass:"token"},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),a("div",{staticStyle:{"font-size":"14px"}},[e._v("父节点层级")]),a("el-select",{staticStyle:{width:"100px","margin-left":"10px"},attrs:{size:"mini",disabled:e.disabled},on:{"visible-change":function(t){return e.handleFocusRuleInput(e.cursorIndex)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(10,(function(e,t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1),a("div",{staticStyle:{"margin-left":"20px","font-size":"14px"}},[e._v("最大长度")]),a("el-form-item",{attrs:{prop:"selectConditions."+n+".maxlength",rules:{required:!0,message:" ",trigger:["blur","change"]}}},[a("el-input",{staticStyle:{width:"100px","margin-left":"10px"},attrs:{size:"mini",maxlength:2,disabled:e.disabled},on:{focus:e.handleFocusWidgetInput,blur:e.handleBlurWidgetInput,input:function(a){return e.handleInputMaxLength(t,a)}},model:{value:t.maxlength,callback:function(a){e.$set(t,"maxlength",a)},expression:"item.maxlength"}})],1)],1):"concat"===t.type?a("div",{staticClass:"token"},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",disabled:e.disabled},on:{"visible-change":function(t){return e.handleFocusRuleInput(e.cursorIndex)}},model:{value:t.selectVal,callback:function(a){e.$set(t,"selectVal",a)},expression:"item.selectVal"}},e._l(e.concatOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:t}})})),1)],1):"index"===t.type?a("div",{staticClass:"token"},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",disabled:e.disabled},on:{"visible-change":function(t){return e.handleFocusRuleInput(e.cursorIndex)}},model:{value:t.typeValue,callback:function(a){e.$set(t,"typeValue",a)},expression:"item.typeValue"}},e._l(e.indexTypeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:t}})})),1),a("div",{staticStyle:{"margin-left":"20px","font-size":"14px"}},[e._v("最大长度")]),a("el-form-item",{attrs:{prop:"selectConditions."+n+".maxlength",rules:{required:!0,message:" ",trigger:["blur","change"]}}},[a("el-input",{staticStyle:{width:"100px","margin-left":"10px"},attrs:{size:"mini",maxlength:2,disabled:e.disabled},on:{focus:e.handleFocusWidgetInput,blur:e.handleBlurWidgetInput,input:function(a){return e.handleInputMaxLength(t,a)}},model:{value:t.maxlength,callback:function(a){e.$set(t,"maxlength",a)},expression:"item.maxlength"}})],1)],1):"time"===t.type?a("div",{staticClass:"token"},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),a("el-form-item",{attrs:{prop:"selectConditions."+n+".value",rules:{required:!0,message:" ",trigger:["blur","change"]}}},[a("el-input",{staticStyle:{width:"130px"},attrs:{size:"mini",placeholder:"yMmDdHhSs.:-",disabled:e.disabled,maxlength:30},on:{focus:e.handleFocusWidgetInput,blur:e.handleBlurWidgetInput,input:function(a){return e.handleInputDateStr(t,a)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)],1):"fixedField"===t.type?a("div",{staticClass:"token"},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),a("el-form-item",{attrs:{prop:"selectConditions."+n+".value",rules:{required:!0,message:" ",trigger:["blur","change"]}}},[a("el-input",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"字母、数字、-、_、点",disabled:e.disabled,maxlength:30},on:{focus:e.handleFocusWidgetInput,blur:e.handleBlurWidgetInput,input:function(a){return e.handleInputFixed(t,a)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)],1):e._e()])]}))],2),a("div",{directives:[{name:"show",rawName:"v-show",value:e.keyboardFocus,expression:"keyboardFocus"}],staticClass:"keyboard"},e._l(e.keyboardList,(function(t,n){return a("el-button",{key:n,attrs:{size:"small",disabled:"index"===t.type&&e.hasIndex},on:{click:function(a){return e.handleSelectKey(t)}}},[e._v(e._s(t.label))])})),1)])],1)},i=[],s=a("d225"),r=a("b0b4"),l=a("308d"),o=a("6bb5"),c=a("4e2b"),u=a("9ab4"),d=a("60a3");function p(e){e=String(e);var t=[0,e.length,!1,!1,!1],a=t[0],n=t[1],i=t[2],s=t[3],r=t[4];while(a<n){var l=e[a];switch(a){case 0:if(!/[\d-]/.test(l))return"";"0"===l?i=!0:"-"===l&&(s=!0);break;case 1:if("."===l){if(s)return"-";r=!0}else{if(i&&"."!==l)return"0";if(!/[\d]/.test(l))return e.substr(0,a)}break;default:if("."===l){if(r)return e.substr(0,a);r=!0}else if(!/\d/.test(l))return e.substr(0,a)}a++}return e}function h(e){return e=p(e),"-"===e.charAt(0)?e.substr(1):e}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(e=p(e),0===t||null===t)t=-1;else if(t<0)return e;var a=e.indexOf(".");return-1!==a?e.substr(0,a+(t+1)):e}function b(e){return f(e,0)}var m=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.keyboardFocus=!1,e.widgetFocus=!1,e.cursorIndex=null,e.areaOptions=[{label:"国家",value:"COUNTRY"},{label:"省级",value:"PROVINCE"},{label:"市级",value:"CITY"},{label:"区县",value:"DISTRICT"}],e.concatOptions=[{label:"短横线",value:"-"},{label:"下划线",value:"_"}],e.indexTypeOptions=[{label:"数字",value:"NUM"},{label:"大写字母",value:"UPPER_CASE"},{label:"小写字母",value:"LOWER_CASE"}],e.keyboardList=[{type:"area",label:"行政区域",value:[]},{type:"baseData",label:"基础数据类型",value:0,maxlength:4},{type:"concat",label:"连接符",selectVal:0,value:""},{type:"index",label:"序号",typeValue:0,sortValue:0,maxlength:4},{type:"time",label:"时间",value:""},{type:"fixedField",label:"固定字段",selectVal:0,value:""}],e.form={selectConditions:[]},e.formRules={},e.hasIndex=!1,e}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"handelExpressionJsonChange",value:function(e){e?(this.form.selectConditions=JSON.parse(e),this.hasIndex=this.form.selectConditions.some((function(e){return"index"===e.type}))):this.form.selectConditions=[]}},{key:"created",value:function(){document.addEventListener("click",this.handleBlurRuleInput,!0),document.addEventListener("keydown",this.handleKeydown)}},{key:"destroyed",value:function(){document.removeEventListener("click",this.handleBlurRuleInput),document.removeEventListener("keydown",this.handleKeydown)}},{key:"handleFocusRuleInput",value:function(e){this.disabled||(this.keyboardFocus=!0,this.cursorIndex=e)}},{key:"handleBlurRuleInput",value:function(){this.keyboardFocus=!1}},{key:"handleFocusWidgetInput",value:function(){this.widgetFocus=!0}},{key:"handleBlurWidgetInput",value:function(){this.widgetFocus=!1}},{key:"handleKeydown",value:function(e){if(this.reactKeydownEvent)switch(e.code.toLocaleLowerCase()){case"backspace":this.handleDeleteToken();break;case"arrowleft":this.handleMoveCursor(!1);break;case"arrowright":this.handleMoveCursor(!0);break}}},{key:"handleSelectKey",value:function(e){var t=JSON.parse(JSON.stringify(e));switch(null===this.cursorIndex?this.form.selectConditions.push(t):(this.form.selectConditions.splice(this.cursorIndex,0,t),this.cursorIndex++),e.type){case"index":this.hasIndex=!0;break}}},{key:"handleDeleteToken",value:function(){var e;switch(null===this.cursorIndex?e=this.form.selectConditions.pop():this.cursorIndex>0&&(e=this.form.selectConditions.splice(this.cursorIndex-1,1)[0]),e.type){case"index":this.hasIndex=!1;break}}},{key:"handleMoveCursor",value:function(e){e?null!==this.cursorIndex&&this.cursorIndex<this.form.selectConditions.length-1?this.cursorIndex++:this.cursorIndex===this.form.selectConditions.length-1&&(this.cursorIndex=null):null===this.cursorIndex?this.cursorIndex=this.form.selectConditions.length-1:this.cursorIndex>0&&this.cursorIndex--}},{key:"getResult",value:function(){var e=this;return new Promise((function(t,a){e.$refs.form.validate((function(n){n?t({preRuleExpress:e.preRuleExpress,ruleExpress:e.ruleExpress,preRuleExpressJson:JSON.stringify(e.form.selectConditions)}):a("表单校验失败")}))}))}},{key:"handleInputMaxLength",value:function(e,t){e.maxlength=h(b(t))}},{key:"handleInputDateStr",value:function(e,t){for(var a=0;a<t.length;a++)if(!/[yMmDdHhSs.:-]/.test(t[a])){e.value=t.substr(0,a);break}}},{key:"handleInputFixed",value:function(e,t){for(var a=0;a<t.length;a++)if(!/[a-zA-Z0-9._-]/.test(t[a])){e.value=t.substr(0,a);break}}},{key:"preRuleExpress",get:function(){var e=this;return this.form.selectConditions.map((function(t){switch(t.type){case"area":return"".concat(t.label,"(").concat(t.value.map((function(t){return e.areaOptions[t].label})).join("，"),")");case"baseData":return"".concat(t.label,"(父节点层级").concat(t.value,"，最大长度").concat(t.maxlength,")");case"concat":return e.concatOptions[t.selectVal].value;case"index":return"".concat(t.label,"(").concat(e.indexTypeOptions[t.typeValue].label,"，最大长度").concat(t.maxlength,")");case"time":case"fixedField":return"".concat(t.label,"(").concat(t.value,")")}})).join("")}},{key:"ruleExpress",get:function(){var e=this;return this.form.selectConditions.map((function(t){switch(t.type){case"area":return"".concat(t.label,'("').concat(t.value.map((function(t){return e.areaOptions[t].value})).join(","),'")');case"baseData":return"".concat(t.label,"(").concat(t.value,",").concat(t.maxlength,")");case"concat":return'连接符("'.concat(e.concatOptions[t.selectVal].value,'")');case"index":return"".concat(t.label,'("').concat(e.indexTypeOptions[t.typeValue].value,'",').concat(t.maxlength,")");case"time":case"fixedField":return"".concat(t.label,'("').concat(t.value,'")')}})).join("+")}},{key:"reactKeydownEvent",get:function(){return this.keyboardFocus&&!this.widgetFocus}}]),t}(d["e"]);u["__decorate"]([Object(d["d"])({type:String})],m.prototype,"expressionJson",void 0),u["__decorate"]([Object(d["d"])({type:Boolean,default:!1})],m.prototype,"disabled",void 0),u["__decorate"]([Object(d["d"])({type:Boolean,default:!0})],m.prototype,"headerVisible",void 0),u["__decorate"]([Object(d["f"])("expressionJson",{immediate:!0})],m.prototype,"handelExpressionJsonChange",null),m=u["__decorate"]([Object(d["a"])({})],m);var v=m,g=v,y=(a("1e1e"),a("2877")),x=Object(y["a"])(g,n,i,!1,null,"47bf3210",null);t["a"]=x.exports},ccd1:function(e,t,a){"use strict";var n={getRuleTree:"/admin/code/rule/listTree",addRuleTree:"/admin/code/rule/add",updateRuleTree:"/admin/code/rule/update",deleteRuleTree:"/admin/code/rule/delete/",getOrgBindRuleList:"/admin/code/rule/bind/listByOrg",getBaseTypeList:"/admin/general/base/getObjectBaseTypeTree",bindRule:"/admin/code/rule/bind/add",updateBindRule:"/admin/code/rule/bind/update",unbindRule:"/admin/code/rule/bind/delete/",getBindRuleDetail:"/admin/code/rule/bind/detail/",getOrgTreeData:"/admin/organization/orgTree",cloneRule:"/admin/code/rule/bind/extends/"};t["a"]=n},cd1c:function(e,t,a){var n=a("e853");e.exports=function(e,t){return new(n(e))(t)}},cf3c:function(e,t,a){},d5a0:function(e,t,a){"use strict";var n=a("18da"),i=a.n(n);i.a},db8e:function(e,t,a){"use strict";var n=a("cf3c"),i=a.n(n);i.a},e853:function(e,t,a){var n=a("d3f4"),i=a("1169"),s=a("2b4c")("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&(t=t[s],null===t&&(t=void 0))),void 0===t?Array:t}}}]);
//# sourceMappingURL=chunk-f9b11148.95720f0f.js.map