(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-b0f5dab2"],{"2b4e":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(e.whichComponent,{tag:"component",attrs:{deviceId:e.deviceId},on:{switch:e.switchComponent}})},l=[],s=a("d225"),n=a("b0b4"),r=a("308d"),o=a("6bb5"),c=a("4e2b"),d=a("9ab4"),u=a("60a3"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("q-left-right-layout",{attrs:{"left-title":"设备归类","right-title":e.currentClassifyName+"详情","btn-tip":"添加一级节点"},on:{click:function(t){return e.openClassifyTreeNodeForm("addTop","")}}},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{slot:"left",data:e.treeData,props:e.defaultProps,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1},on:{"node-click":e.handleNodeClick},slot:"left",scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,l=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticStyle:{display:"inline-block","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","word-break":"keep-all"},style:{width:190-18*(i.level-1)+"px"},attrs:{title:i.label}},[e._v("\n          "+e._s(i.label)+"\n        ")]),a("span",[a("el-button",{staticClass:"el-icon-plus",attrs:{type:"text",size:"mini",title:"添加子节点"},on:{click:function(t){return t.stopPropagation(),function(){return e.openClassifyTreeNodeForm("add",l)}()}}}),a("el-button",{staticClass:"el-icon-edit",attrs:{type:"text",size:"mini",title:"编辑节点"},on:{click:function(t){return t.stopPropagation(),function(){return e.openClassifyTreeNodeForm("edit",l)}()}}}),a("el-button",{staticClass:"el-icon-delete",attrs:{type:"text",size:"mini",title:"删除节点"},on:{click:function(t){return t.stopPropagation(),function(){return e.remove(i,l)}()}}})],1)])}}])}),a("div",{staticClass:"right",attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"basic-attribute"},[a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu icon-blue"}),e._v("基础信息")]),a("div",{staticClass:"basic-attribute-body"},[a("el-form",{ref:"",attrs:{"label-width":"100px",size:"mini","status-icon":"",model:e.basicForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"名称："}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.basicForm.name,callback:function(t){e.$set(e.basicForm,"name",t)},expression:"basicForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"编码："}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.basicForm.code,callback:function(t){e.$set(e.basicForm,"code",t)},expression:"basicForm.code"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上级菜单："}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.basicForm.parentName,callback:function(t){e.$set(e.basicForm,"parentName",t)},expression:"basicForm.parentName"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{attrs:{type:"textarea",rows:3,size:"small",disabled:""},model:{value:e.basicForm.remark,callback:function(t){e.$set(e.basicForm,"remark",t)},expression:"basicForm.remark"}})],1)],1)],1)],1)],1)]),a("classify-device",{key:e.currentClassifyId,staticStyle:{"margin-top":"20px"},attrs:{currentId:e.currentClassifyId,paging:e.paging},on:{switch:function(t,a){return e.$emit("switch",t,a)}}})],1)],1),a("el-dialog",{attrs:{title:"设备归类信息",visible:e.classifyTreeNodeDialog,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.classifyTreeNodeDialog=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"dialogBasicForm",attrs:{"label-width":"100px",size:"small",model:e.dialogBasicForm,rules:e.addRules}},[a("el-form-item",{attrs:{label:"归类名称：",prop:"name"}},[a("el-input",{attrs:{size:"small",maxlength:100,placeholder:"请输入归类名称"},model:{value:e.dialogBasicForm.name,callback:function(t){e.$set(e.dialogBasicForm,"name",t)},expression:"dialogBasicForm.name"}})],1),a("el-form-item",{attrs:{label:"归类编码：",prop:"code"}},[a("el-input",{attrs:{size:"small",maxlength:100,placeholder:"包含字母、数字、横线、下划线和点,点不能作为开头,长度3-100位"},model:{value:e.dialogBasicForm.code,callback:function(t){e.$set(e.dialogBasicForm,"code",t)},expression:"dialogBasicForm.code"}})],1),a("el-form-item",{attrs:{label:"上级菜单：",prop:"parentName"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.dialogBasicForm.parentName,callback:function(t){e.$set(e.dialogBasicForm,"parentName",t)},expression:"dialogBasicForm.parentName"}})],1),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",rows:3,size:"small",maxlength:225},model:{value:e.dialogBasicForm.remark,callback:function(t){e.$set(e.dialogBasicForm,"remark",t)},expression:"dialogBasicForm.remark"}})],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.classifyTreeNodeDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.saveClassify()}}},[e._v("确 定")])],1)],1)],1)],1)},p=[],g=(a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"custom-attribute"},[a("div",{staticClass:"custom-attribute-header"},[e._m(0),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.currentId,expression:"currentId"}],attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:e.handleAddFunc}},[e._v("添加设备")])],1),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","min-height":"calc(100vh - 620px)"},attrs:{data:e.deviceData}},[a("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"100"}}),a("el-table-column",{attrs:{prop:"deviceName",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"deviceCode",label:"编码"}}),a("el-table-column",{attrs:{prop:"typeDetailName",label:"设备类型"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(a){return e.$emit("switch","DeviceDetail",t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelFunc(t.row)}}},[e._v("删除")])]}}])})],1),a("q-pagination",{attrs:{"current-page":e.paging.current,"page-size":e.paging.size,layout:"total, prev, pager, next",total:e.paging.total},on:{"current-change":e.getClassifyDeviceList,"update:currentPage":function(t){return e.$set(e.paging,"current",t)},"update:current-page":function(t){return e.$set(e.paging,"current",t)}}})],1)]),a("el-dialog",{attrs:{title:"添加设备",visible:e.addDeviceDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addDeviceDialog=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-form",{attrs:{inline:!0,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{maxlength:100,placeholder:"名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.dialogPaging.query.name,callback:function(t){e.$set(e.dialogPaging.query,"name",t)},expression:"dialogPaging.query.name"}})],1),a("el-form-item",[a("el-input",{attrs:{maxlength:100,placeholder:"编码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.dialogPaging.query.code,callback:function(t){e.$set(e.dialogPaging.query,"code",t)},expression:"dialogPaging.query.code"}})],1),a("el-form-item",[a("q-search-button",{on:{click:e.listNotBindByClassifyId}})],1)],1),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.allDeviceTableData}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"code",label:"编码"}}),a("el-table-column",{attrs:{prop:"typeDetailName",label:"设备类型"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDeviceChoose(t.row,t.$index)}}},[e._v("添加")])]}}])})],1),a("q-pagination",{attrs:{"current-page":e.dialogPaging.current,"page-size":e.dialogPaging.size,layout:"total, prev, pager, next",total:e.dialogPaging.total},on:{"update:currentPage":function(t){return e.$set(e.dialogPaging,"current",t)},"update:current-page":function(t){return e.$set(e.dialogPaging,"current",t)},"current-change":e.listNotBindByClassifyId}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addDeviceDialog=!1}}},[e._v("取 消")])],1)])],1)}),f=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("i",{staticClass:"el-icon-menu icon-blue"}),e._v("设备列表")])}],b=(a("c5f6"),a("ef0f")),v=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(r["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.loading=!1,e.allDeviceTableData=[],e.addDeviceDialog=!1,e.deviceData=[],e.dialogPaging={size:10,current:1,total:0,query:{name:"",code:""}},e}return Object(c["a"])(t,e),Object(n["a"])(t,[{key:"created",value:function(){this.currentId&&this.getClassifyDeviceList()}},{key:"getClassifyDeviceList",value:function(){var e=this;this.$http.post(b["a"].getClaasifyDeviceList+this.currentId,this.paging).then((function(t){t.data.status?(e.deviceData=t.data.data.records,e.paging.total=t.data.data.total):e.$message.error(t.data.message)}))}},{key:"listNotBindByClassifyId",value:function(){var e=this;this.loading=!0,this.$http.post(b["a"].listNotBindByClassifyId+this.currentId,this.dialogPaging).then((function(t){e.loading=!1,t.data.status?(e.allDeviceTableData=t.data.data.records,e.dialogPaging.total=t.data.data.total):e.$message.error(t.data.message)})).catch((function(){e.loading=!1}))}},{key:"handleAddFunc",value:function(){this.listNotBindByClassifyId(),this.addDeviceDialog=!0}},{key:"handleDeviceChoose",value:function(e,t){var a=this;this.$http.post(b["a"].classifyBind,{deviceClassifyId:this.currentId,deviceId:e.id}).then((function(e){e.data.status?(a.$message.success("添加成功"),a.listNotBindByClassifyId(),a.getClassifyDeviceList()):a.$message.error(e.data.message)}))}},{key:"handleDelFunc",value:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.get(b["a"].classifyUnbind+e.id).then((function(e){e.data.status?(t.$message.success("删除成功"),t.getClassifyDeviceList()):t.$message.error(e.data.message)}))}))}}]),t}(u["e"]);d["__decorate"]([Object(u["d"])({type:[String,Number],default:""})],v.prototype,"currentId",void 0),d["__decorate"]([Object(u["d"])({type:Number})],v.prototype,"deviceTableDataTotal",void 0),d["__decorate"]([Object(u["d"])({type:Object})],v.prototype,"paging",void 0),v=d["__decorate"]([Object(u["a"])({components:{}})],v);var h=v,y=h,k=(a("df14"),a("2877")),C=Object(k["a"])(y,g,f,!1,null,"4f442e81",null),D=C.exports,x=a("73ec"),w=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(r["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.treeData=[],e.defaultProps={children:"children",label:"name"},e.currentClassifyId="",e.currentClassifyName="",e.basicForm={},e.classifyTreeNodeDialog=!1,e.dialogBasicForm={id:"",parentId:null,parentName:"",name:"",code:"",remark:""},e.loading=!1,e.addRules={name:{required:!0,message:"请输入名称",trigger:"blur"},code:{required:!0,message:"请输入编码",trigger:"blur"}},e.paging={size:10,current:1,total:0,query:{}},e}return Object(c["a"])(t,e),Object(n["a"])(t,[{key:"created",value:function(){this.getClassifyTreeData()}},{key:"getClassifyTreeData",value:function(){var e=this;this.$http.get(b["a"].classifyTree).then((function(t){t.data.status?(e.treeData=t.data.data,e.treeData.length&&e.handleNodeClick(e.treeData[0])):e.$message.error(t.data.message)}))}},{key:"handleNodeClick",value:function(e){this.basicForm=e,this.currentClassifyId=e.id,this.currentClassifyName=e.name}},{key:"saveClassify",value:function(){var e=this,t=this.$refs.dialogBasicForm;t.validate((function(t){if(t){e.loading=!0;var a=e.dialogBasicForm.id?b["a"].updateClassify:b["a"].addClassify;e.$http.post(a,e.dialogBasicForm).then((function(t){e.loading=!1,t.data.status?(e.$message.success("操作成功"),e.classifyTreeNodeDialog=!1,e.getClassifyTreeData()):e.$message({message:t.data.message,type:"error"})})).catch((function(){e.loading=!1}))}}))}},{key:"openClassifyTreeNodeForm",value:function(e,t){var a=this;this.classifyTreeNodeDialog=!0,this.$nextTick((function(){var i=a.$refs.dialogBasicForm;switch(i.resetFields(),e){case"add":a.dialogBasicForm={id:"",parentId:t.id,parentName:t.name,name:"",code:"",remark:"",level:t.level+1};break;case"edit":x["a"].mapValue(a.dialogBasicForm,t);break;case"addTop":a.dialogBasicForm={id:"",parentId:null,parentName:"",name:"",code:"",remark:"",level:1};break}}))}},{key:"remove",value:function(e,t){var a=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$http.get("".concat(b["a"].deleteClassify).concat(t.id)).then((function(e){e.status&&(e.data.status?(a.$message.success("操作成功"),a.getClassifyTreeData()):a.$message({showClose:!0,message:e.data.message,type:"error"}))}))})).catch((function(){}))}}]),t}(u["e"]);w=d["__decorate"]([Object(u["a"])({components:{ClassifyDevice:D}})],w);var F=w,$=F,_=(a("f228"),Object(k["a"])($,m,p,!1,null,"b91e5966",null)),N=_.exports,B=a("b9f5"),I=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(r["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.whichComponent="DeviceArchived",e.deviceId="",e}return Object(c["a"])(t,e),Object(n["a"])(t,[{key:"switchComponent",value:function(e,t){switch(e){case"DeviceDetail":this.whichComponent="DeviceDetail",this.deviceId=t.deviceId;break;default:this.whichComponent="DeviceArchived",this.deviceId=""}}}]),t}(u["e"]);I=d["__decorate"]([Object(u["a"])({components:{DeviceArchived:N,DeviceDetail:B["a"]}})],I);var O=I,T=O,z=Object(k["a"])(T,i,l,!1,null,"447596d6",null);t["default"]=z.exports},"53ad":function(e,t,a){},"6b3e":function(e,t,a){},df14:function(e,t,a){"use strict";var i=a("6b3e"),l=a.n(i);l.a},f228:function(e,t,a){"use strict";var i=a("53ad"),l=a.n(i);l.a}}]);
//# sourceMappingURL=chunk-b0f5dab2.9ac688eb.js.map