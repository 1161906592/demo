(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-a88175ea"],{3440:function(e,t,a){"use strict";var i={getPaging:"/admin/car/pagingCar",add:"/admin/car/add",update:"/admin/car/update",delete:"/admin/car/delete",multipleDelete:"/admin/car/multipleDelete",getOneById:"/admin/car/get",getBindDevice:"/admin/carDevice/listDeviceByCarId/carId/",bindDevice:"/admin/carDevice/bind/carId/",cancelBindDevice:"/admin/carDevice/unbind",updateGps:"/admin/carDevice/updateGPSMark/carDeviceId/",findTypeTree:"/admin/typeDetail/findTypeTree",getOrgTreeData:"/admin/organization/orgTree",getNewOrgTree:"/admin/organization/orgTree/car",getTemplateByTypeDetaiId:"/admin/typeDetail/getTemplateByTypeDetaiId",getPersonPaging:"/admin/person/pagingCarPerson",getDevicePaging:"/admin/device/pagingDevice",getTypeDetail:"/admin/typeDetail",deleteType:"/admin/typeDetail/delete",saveCustomAttrItems:"/admin/typeDetail/saveCustomAttrItems",typeTree:{getData:"/admin/typeDetail/findTypeTree/car"},treeItem:{getDetail:"/admin/typeDetail/attr/pagingAttr/car/",add:"/admin/typeDetail/addTypeAndAttrs/car",update:"/admin/typeDetail/updateTypeAndAttrs/car",delete:"/admin/typeDetail/delete/",changeAttrItemMustInput:"/admin/typeDetail/saveCustomAttrItems"},transfer:{getData:"/admin/typeDetail/attr/transferData/car"},carDetail:{getDetail:"/admin/car/get/",getCustom:"/admin/typeDetail/getTemplateByTypeDetaiId/"},download:"/api/excel/download/carTemplate",upload:"/api/excel/upload/carTemplate"};t["a"]=i},"4acb":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageDataIsLoading,expression:"pageDataIsLoading"}],staticClass:"container"},[a("q-left-right-layout",{staticClass:"main-container",attrs:{"left-title":"车辆类型","btn-tip":"添加一级节点","right-title":(e.basicForm.name||"")+"详情"},on:{click:function(t){return e.openTypeTreeNodeForm("addTop","")}}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("el-input",{staticStyle:{"margin-bottom":"10px",padding:"0 10px"},attrs:{placeholder:"输入关键字进行过滤",maxlength:100,size:"small"},model:{value:e.treeMessage.filterText,callback:function(t){e.$set(e.treeMessage,"filterText",t)},expression:"treeMessage.filterText"}}),a("div",{staticClass:"tree-content"},[a("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.treeMessage.data,props:e.treeMessage.defaultProps,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticStyle:{display:"inline-block","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","word-break":"keep-all"},style:{width:190-18*(i.level-1)+"px"},attrs:{title:i.label}},[e._v("\n              "+e._s(i.label)+"\n            ")]),a("span",[a("el-button",{staticClass:"el-icon-plus",attrs:{type:"text",size:"mini",title:"添加子节点"},on:{click:function(t){return e.openTypeTreeNodeForm("add",s)}}}),a("el-button",{staticClass:"el-icon-edit",attrs:{type:"text",size:"mini",title:"编辑节点"},on:{click:function(t){return e.openTypeTreeNodeForm("edit",s)}}}),a("el-button",{staticClass:"el-icon-delete",attrs:{type:"text",size:"mini",title:"删除节点"},on:{click:function(t){return e.remove(i,s)}}})],1)])}}])})],1)],1),a("div",{staticClass:"right",attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"basic-attribute"},[a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu"}),e._v("基础信息")]),a("div",{staticClass:"basic-attribute-body"},[a("el-form",{attrs:{"label-width":"100px",size:"small","status-icon":"",model:e.basicForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"名称：",prop:"name"}},[a("el-input",{attrs:{disabled:""},model:{value:e.basicForm.name,callback:function(t){e.$set(e.basicForm,"name",t)},expression:"basicForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"父节点名称："}},[a("el-input",{attrs:{disabled:""},model:{value:e.basicForm.parentName,callback:function(t){e.$set(e.basicForm,"parentName",t)},expression:"basicForm.parentName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"编号：",prop:"code"}},[a("el-input",{attrs:{disabled:""},model:{value:e.basicForm.code,callback:function(t){e.$set(e.basicForm,"code",t)},expression:"basicForm.code"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"图标：",prop:"icons"}},[a("q-upload",{attrs:{prev:"",disabled:"","limit-num":1,accept:"image/png,image/jpeg",size:2},model:{value:e.basicForm.icons,callback:function(t){e.$set(e.basicForm,"icons",t)},expression:"basicForm.icons"}})],1)],1)],1)],1)],1)]),e.hasCustomRole?a("div",{staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"content-title"},[a("el-icon",{staticClass:"el-icon-menu icon-blue"}),e._v("\n          自定义信息\n        ")],1),a("base-data-info-table",{ref:"baseDataInfoTable",attrs:{id:e.basicForm.id,active:"/admin/typeDetail/attr/pagingAttr/car/"}})],1):e._e()])]),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visibleDialog,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.visibleDialog=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.doLoading,expression:"doLoading"}]},[a("el-form",{ref:"formData",attrs:{"label-width":"100px",size:"small",model:e.formData,rules:e.formRules}},[a("el-form-item",{attrs:{label:"名称：",prop:"name"}},[a("el-input",{attrs:{size:"small",maxlength:100},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"编码：",prop:"code"}},[a("el-input",{attrs:{size:"small",maxlength:100,placeholder:"包含字母、数字、横线、下划线和点,点不能作为开头,长度3-100位"},model:{value:e.formData.code,callback:function(t){e.$set(e.formData,"code",t)},expression:"formData.code"}})],1),a("el-form-item",{attrs:{label:"图标：",prop:"icons"}},[a("q-upload",{attrs:{"limit-num":1,accept:"image/png,image/jpeg",size:2},model:{value:e.formData.icons,callback:function(t){e.$set(e.formData,"icons",t)},expression:"formData.icons"}})],1),e.hasCustomRole?a("div",{staticClass:"transfer"},[a("el-transfer",{staticStyle:{margin:"auto"},attrs:{filterable:"",titles:["未选择","已选择"],"button-texts":["解绑","绑定"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:e.transferData.data},model:{value:e.transferData.selected,callback:function(t){e.$set(e.transferData,"selected",t)},expression:"transferData.selected"}})],1):e._e()],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.visibleDialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.saveTypeAndAttr()}}},[e._v("确定")])],1)],1)])],1)},s=[],r=(a("96cf"),a("3b8d")),n=a("d225"),o=a("b0b4"),l=a("308d"),c=a("6bb5"),d=a("4e2b"),m=a("9ab4"),p=a("60a3"),u=a("3440"),g=a("0933"),f=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.pageDataIsLoading=!0,e.doLoading=!1,e.method="add",e.treeMessage={filterText:"",data:[],defaultProps:{children:"children",label:"name"}},e.basicForm={},e.dialogTitle="",e.visibleDialog=!1,e.formData={id:"",name:"",code:"",icons:[]},e.formRules={name:{required:!0,trigger:"blur",message:"请输入名称"},code:{required:!0,trigger:"blur",message:"请输入编码"}},e.transferData={data:[],selected:[]},e.hasCustomRole=qTouch.getBaseTypeByCode("car"),e}return Object(d["a"])(t,e),Object(o["a"])(t,[{key:"created",value:function(){var e=this;this.getTypeTreeData().then((function(){return e.pageDataIsLoading=!1}))}},{key:"getTypeTreeData",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get(u["a"].typeTree.getData);case 3:t=e.sent,a=t.data,i=a.status,s=a.data,r=a.message,i?(this.treeMessage.data=s||[],!this.basicForm.id&&s&&this.handleNodeClick(this.treeMessage.data[0])):this.$message.error(r),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),this.$message.error("请求错误，请重试！");case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleNodeClick",value:function(e){this.basicForm=Object.assign({},e),this.basicForm.icon&&(this.basicForm.icons=[{name:"icon",url:this.basicForm.icon}])}},{key:"openTypeTreeNodeForm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=arguments.length>1?arguments[1]:void 0;switch(e){case"add":this.method="add",this.dialogTitle="添加车辆类型",this.formData={parentId:t.id,level:t.level+1,icons:[]};break;case"edit":this.method="edit",this.dialogTitle="编辑车辆类型",this.formData=Object.assign({},t),this.formData.icon&&(this.formData.icons=[{name:"icon",url:this.formData.icon}]);break;case"addTop":this.method="add",this.dialogTitle="添加车辆类型",this.formData={level:1,icons:[]};break;default:this.formData={icons:[]}}this.visibleDialog=!0,this.getTypeAndAttrs()}},{key:"getTypeAndAttrs",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.transferData.data=[],e.next=3,this.$http.get(u["a"].transfer.getData+"?typeDetailId="+this.formData.id);case 3:t=e.sent,a=t.data,i=a.data,s=a.status,r=a.message,s?(this.transferData.data=i.data.map((function(e){return{key:e.id,label:e.attrName}})),this.transferData.selected=i.selected):this.$message.error(r);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveTypeAndAttr",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,r,n,o,l=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.doLoading=!0,this.$refs.formData.validate((function(e){e||(l.doLoading=!1)})),t=this.formData.id?u["a"].treeItem.update:u["a"].treeItem.add,a=Object.assign(this.formData,{attrs:this.transferData.selected}),a.icons&&a.icons.length?a.icon=a.icons[0].url?a.icons[0].url:"":a.icon="",e.prev=5,e.next=8,this.$http.post(t,a);case 8:i=e.sent,s=i.data,r=s.status,n=s.data,o=s.message,r?(this.$message.success(o),this.visibleDialog=!1,this.basicForm=Object.assign({},n),this.$refs["baseDataInfoTable"].getCustomAttributeList(),this.getTypeTreeData().then((function(){return l.pageDataIsLoading=!1}))):this.$message.error(o),this.doLoading=!1,e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](5),this.$message.error("请求错误，请重试！");case 20:case"end":return e.stop()}}),e,this,[[5,17]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"remove",value:function(e,t){var a=this;this.$confirm("删除该类型将会删除其所有子类型及下属数据，是否删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$http.get(u["a"].treeItem.delete+t.id).then((function(e){e.data.status?(a.$message.success("删除成功"),a.basicForm={},a.getTypeTreeData()):a.$message.error(e.data.message)}))}))}},{key:"setFilterText",value:function(e){this.$refs.tree.filter(e)}},{key:"filterNode",value:function(e,t){return!e||-1!==t[this.treeMessage.defaultProps.label].indexOf(e)}}]),t}(p["e"]);m["__decorate"]([Object(p["f"])("treeMessage.filterText")],f.prototype,"setFilterText",null),f=m["__decorate"]([Object(p["a"])({filters:{formatterAttrType:g["a"]}})],f);var h=f,b=h,v=(a("aac8"),a("2877")),D=Object(v["a"])(b,i,s,!1,null,"f9d291e6",null);t["default"]=D.exports},aac8:function(e,t,a){"use strict";var i=a("e15d"),s=a.n(i);s.a},e15d:function(e,t,a){}}]);
//# sourceMappingURL=chunk-a88175ea.1fd88534.js.map